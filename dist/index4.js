var C="function"==typeof Object.defineProperties?Object.defineProperty:function(y,x,f){if(y==Array.prototype||y==Object.prototype)return y;y[x]=f.value;return y};function F(y){y=["object"==typeof globalThis&&globalThis,y,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var x=0;x<y.length;++x){var f=y[x];if(f&&f.Math==Math)return f}throw Error("Cannot find global object");}var G=F(this);
function I(y,x){if(x)a:{var f=G;y=y.split(".");for(var u=0;u<y.length-1;u++){var z=y[u];if(!(z in f))break a;f=f[z]}y=y[y.length-1];u=f[y];x=x(u);x!=u&&null!=x&&C(f,y,{configurable:!0,writable:!0,value:x})}}var J;if("function"==typeof Object.setPrototypeOf)J=Object.setPrototypeOf;else{var K;a:{var L={a:!0},N={};try{N.__proto__=L;K=N.a;break a}catch(y){}K=!1}J=K?function(y,x){y.__proto__=x;if(y.__proto__!==x)throw new TypeError(y+" is not extensible");return y}:null}var Q=J;
I("Object.setPrototypeOf",function(y){return y||Q});function U(y){var x=0;return function(){return x<y.length?{done:!1,value:y[x++]}:{done:!0}}}I("Symbol",function(y){function x(r){if(this instanceof x)throw new TypeError("Symbol is not a constructor");return new f(u+(r||"")+"_"+z++,r)}function f(r,n){this.Nb=r;C(this,"description",{configurable:!0,writable:!0,value:n})}if(y)return y;f.prototype.toString=function(){return this.Nb};var u="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",z=0;return x});
I("Symbol.iterator",function(y){if(y)return y;y=Symbol("Symbol.iterator");for(var x="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<x.length;f++){var u=G[x[f]];"function"===typeof u&&"function"!=typeof u.prototype[y]&&C(u.prototype,y,{configurable:!0,writable:!0,value:function(){return V(U(this))}})}return y});function V(y){y={next:y};y[Symbol.iterator]=function(){return this};return y}
function W(y,x){y instanceof String&&(y+="");var f=0,u=!1,z={next:function(){if(!u&&f<y.length){var r=f++;return{value:x(r,y[r]),done:!1}}u=!0;return{done:!0,value:void 0}}};z[Symbol.iterator]=function(){return z};return z}I("Array.prototype.keys",function(y){return y?y:function(){return W(this,function(x){return x})}});
I("Array.prototype.fill",function(y){return y?y:function(x,f,u){var z=this.length||0;0>f&&(f=Math.max(0,z+f));if(null==u||u>z)u=z;u=Number(u);0>u&&(u=Math.max(0,z+u));for(f=Number(f||0);f<u;f++)this[f]=x;return this}});function X(y){return y?y:Array.prototype.fill}I("Int8Array.prototype.fill",X);I("Uint8Array.prototype.fill",X);I("Uint8ClampedArray.prototype.fill",X);I("Int16Array.prototype.fill",X);I("Uint16Array.prototype.fill",X);I("Int32Array.prototype.fill",X);
I("Uint32Array.prototype.fill",X);I("Float32Array.prototype.fill",X);I("Float64Array.prototype.fill",X);
var Y=this&&this.Nb||function(){function y(x,f){y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,z){u.__proto__=z}||function(u,z){for(var r in z)Object.prototype.hasOwnProperty.call(z,r)&&(u[r]=z[r])};return y(x,f)}return function(x,f){function u(){this.constructor=x}if("function"!==typeof f&&null!==f)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");y(x,f);x.prototype=null===f?Object.create(f):(u.prototype=f.prototype,new u)}}();
define("core/base/BaseBean",["require","exports"],function(y,x){Object.defineProperty(x,"__esModule",{value:!0});x.$=x.ea=x.Xa=x.la=x.h=void 0;y=function(){return function(u,z){this.Z="41";this.y=this.x=0;this.x=u;this.y=z}}();x.h=y;var f=function(u){function z(r,n,e){void 0===e&&(e=0);r=u.call(this,r,n)||this;r.type=0;r.type=e;r.Z="42";return r}Y(z,u);return z}(y);x.la=f;y=function(u){function z(r,n,e){void 0===e&&(e=0);r=u.call(this,r,n)||this;r.R=0;r.R=e;r.Z="43";return r}Y(z,u);return z}(y);x.Xa=
y;x.ea=function(){function u(){}u.click="click";u.zd="dblclick";u.Kd="mousedown";u.gd="mouseup";u.fd="mousemove";u.ed="mouseenterleave";u.Hd="dragmousemove";u.anchor="anchor";u.scale="scale";u.onclick="onclick";u.ondblclick="ondblclick";u.onmousedown="onmousedown";u.onmouseup="onmouseup";u.onmouseenter="onmouseenter";u.onmouseleave="onmouseleave";u.onmousemove="onmousemove";u.Ta="ondragmousemove";u.Sb="onanchor";u.Tb="onunanchor";return u}();x.$=function(){function u(){}u.default="default";u.move=
"move";u.Zc="crosshair";u.Zb="se-resize";u.Rb="ne-resize";u.md="pointer";u.od="s-resize";u.qd="w-resize";return u}()});
define("core/base/Pen",["require","exports"],function(y,x){Object.defineProperty(x,"__esModule",{value:!0});x.Ha=void 0;y=function(){function f(){this.Z="31";this.strokeStyle=this.fillStyle="#000000";this.I=!1;this.D=this.N=!0;this.lineWidth=1}f.prototype.qa=function(u,z){this.I&&this.fillStyle&&(u.fillStyle=this.fillStyle);this.N&&this.strokeStyle&&(u.strokeStyle=this.strokeStyle,u.lineWidth=this.lineWidth);this.show(u,z)};return f}();x.Ha=y});
define("layer/BeanFactory","require exports core/base/BaseBean core/base/BaseShape process/ProcProc core/base/LinkLine util/CommonUtil".split(" "),function(y,x,f,u,z,r,n){Object.defineProperty(x,"__esModule",{value:!0});x.Fb=void 0;x.Fb=function(){function e(){}e.createNode=function(a){var b=n.L.W(),h=null;switch(a){case "11":h=new z.jc(b,new f.h(0,0),100,60,[],!1);break;case "12":h=new z.bc(b,new f.h(0,0),100,60,[],!1);break;case "13":h=new z.ec(b,new f.h(0,0),100,60,[],!1);break;case "14":h=new z.dc(b,
new f.h(0,0),60,60,[],!1);break;case "15":h=new z.ic(b,new f.h(0,0),100,60,[],!1);break;case "16":h=new z.fc(b,new f.h(0,0),100,60,[],!1)}return h};e.xd=function(a){var b=null;switch(a){case "32":b=new u.ac(new f.h(0,0),10,14,3);break;case "33":b=new u.Qc(new f.h(0,0),new f.h(1,1),new f.h(2,2));break;case "34":b=new u.rb([]);break;case "35":b=new u.Rect(new f.h(0,0),60,60);break;case "36":b=new u.cc(new f.h(0,0),100,60);break;case "37":b=new u.hc(new f.h(0,0),new f.h(0,0));break;case "8":b=new u.Lc(new f.h(0,
0),2);break;case "39":b=new u.V(new f.h(0,0),2);break;case "391":b=new u.Hb(null,new f.h(0,0),[],20)}return b};e.yd=function(a){var b=null;switch(a){case "41":b=new f.h(0,0);break;case "42":b=new f.la(0,0);break;case "43":b=new f.Xa(0,0)}return b};e.wd=function(a){var b=null;switch(a){case "21":b=new r.Aa(n.L.W(),new f.h(0,0),new f.h(200,200),0);break;case "22":b=new r.mc(n.L.W(),new f.h(0,0),new f.h(200,200),0)}return b};e.Wc=function(a){if(!a)return null;var b=null;switch(a.substr(0,1)){case "1":b=
e.createNode(a);break;case "2":b=e.wd(a);break;case "3":b=e.xd(a);break;case "4":b=e.yd(a)}return b};return e}()});
define("util/CommonUtil",["require","exports","core/base/LinkLine","core/base/Node","layer/BeanFactory"],function(y,x,f,u,z){Object.defineProperty(x,"__esModule",{value:!0});x.L=void 0;x.L=function(){function r(){}r.W=function(){return Date.now()+"_"+Math.ceil(100*Math.random())+"_"+Math.ceil(100*Math.random())+"_"+Math.ceil(100*Math.random())};r.Db=function(n){if(!n)return n;if(n instanceof Array){var e=[];if(1>n.length)return e;if(n[0]instanceof u.Node||n[0]instanceof f.Aa)return null;for(var a=
0;a<n.length;a++){var b=n[a];if(b)switch(typeof b){case "bigint":case "number":case "string":case "boolean":e[a]=b;break;case "object":b instanceof u.Node||b instanceof f.Aa||(e[a]=r.Db(b))}else e[a]=b}return e}e=0;var h={},t=Object.keys(n);for(a=0;a<t.length;a++){b=t[a];var w=Object.getOwnPropertyDescriptor(n,b);if(w)if(w.value)switch(typeof w.value){case "bigint":case "number":case "string":case "boolean":h[b]=w.value;e++;break;case "object":w.value instanceof u.Node||w.value instanceof f.Aa||(w=
r.Db(w.value))&&(h[b]=w)}else h[b]=w.value}return 0>=e?null:h};r.Cb=function(n){if(!n)return n;if(n instanceof Array){var e=[];if(1>n.length)return e;if(n[0]instanceof f.Aa)return null;for(var a=0;a<n.length;a++){var b=n[a];if(b)switch(typeof b){case "bigint":case "number":case "string":case "boolean":e[a]=b;break;case "object":b instanceof f.Aa||(e[a]=b instanceof u.Node?{objtype:b.Z,id:b.id}:r.Cb(b))}else e[a]=b}return e}e={};var h=0,t=Object.keys(n);for(a=0;a<t.length;a++)if(b=t[a],"linePath"!=
b){var w=Object.getOwnPropertyDescriptor(n,b);if(w)if(w.value)switch(typeof w.value){case "bigint":case "number":case "string":case "boolean":e[b]=w.value;h++;break;case "object":w.value instanceof f.Aa||(w.value instanceof u.Node?e[b]={objtype:w.value.Z,id:w.value.id}:(w=r.Cb(w.value))&&(e[b]=w))}else e[b]=w.value}return 0>=h?null:e};r.Xc=function(n){if(!n)return null;var e=Object.getOwnPropertyDescriptor(n,"objtype");return e&&e.value&&"string"==typeof e.value?((e=z.Fb.Wc(e.value))&&r.qc(e,n),e):
null};r.qc=function(n,e){if(n&&e)for(var a=Object.keys(e),b=Object.keys(n),h=0;h<a.length;h++){var t=a[h],w=Object.getOwnPropertyDescriptor(e,t);if(w)if(w.value){var A=typeof w.value;if(0>b.indexOf(t))"object"==A?(A=r.Xc(w.value))?Object.defineProperty(n,t,{value:A,configurable:!0,writable:!0}):Object.defineProperty(n,t,w):Object.defineProperty(n,t,w);else{var B=Object.getOwnPropertyDescriptor(n,t);if(!B||!B.value)"object"==A?(A=r.Xc(w.value))?Object.defineProperty(n,t,{value:A,configurable:!0,writable:!0}):
Object.defineProperty(n,t,w):Object.defineProperty(n,t,w);else if(A==typeof B.value)switch(A){case "bigint":case "number":case "string":case "boolean":case "undefined":Object.defineProperty(n,t,w);break;case "object":r.qc(B.value,w.value)}}}else Object.defineProperty(n,t,w)}};r.Yc=function(n,e){if(!e)return null;var a=Object.getOwnPropertyDescriptor(e,"objtype");if(a&&a.value&&"string"==typeof a.value)if("1"==a.value.charAt(0)){if((e=Object.getOwnPropertyDescriptor(e,"id"))&&e.value&&"string"==typeof e.value)for(a=
0;a<n.J.length;a++){var b=n.J[a];if(e.value==b.id)return b}}else return(a=z.Fb.Wc(a.value))&&r.rc(n,a,e),a;return null};r.rc=function(n,e,a){if(e&&a)for(var b=Object.keys(a),h=Object.keys(e),t=0;t<b.length;t++){var w=b[t],A=Object.getOwnPropertyDescriptor(a,w);if(A)if(A.value){var B=typeof A.value;if(0>h.indexOf(w))"object"==B?(B=r.Yc(n,A.value))?Object.defineProperty(e,w,{value:B,configurable:!0,writable:!0}):Object.defineProperty(e,w,A):Object.defineProperty(e,w,A);else{var D=Object.getOwnPropertyDescriptor(e,
w);if(!D||!D.value)"object"==B?(B=r.Yc(n,A.value))?Object.defineProperty(e,w,{value:B,configurable:!0,writable:!0}):Object.defineProperty(e,w,A):Object.defineProperty(e,w,A);else if(B==typeof D.value)switch(B){case "bigint":case "number":case "string":case "boolean":case "undefined":Object.defineProperty(e,w,A);break;case "object":r.rc(n,D.value,A.value)}}}else Object.defineProperty(e,w,A)}};return r}()});
define("layer/DrawLayer","require exports core/base/BaseBean core/base/LinkLine core/base/Node util/CommonUtil layer/Action layer/BeanFactory".split(" "),function(y,x,f,u,z,r,n,e){Object.defineProperty(x,"__esModule",{value:!0});x.Mc=void 0;y=function(){function a(b){this.Ld=[f.ea.click,f.ea.zd,f.ea.Kd,f.ea.gd,f.ea.Hd,f.ea.ed];this.J=[];this.lines=[];this.bb={};this.tb=this.Ub=this.za=this.ua=this.Kb=this.anchorNode=this.ka=this.Ra=null;this.sa=new u.Aa(r.L.W(),new f.h(0,0),new f.h(0,0),0);this.wb=
!1;this.bd="11";this.O=!1;this.Oa=new f.h(1,1);this.cb=!1;this.A=this.T=null;this.G=new f.h(0,0);this.Lb=0;this.Mb="";this.M=this.S=null;this.Sa=new f.h(0,0);this.ob=new f.h(0,0);this.La=this.ab=null;this.Ob=10;this.Pb=1;this.maxHeight=this.maxWidth=15E3;this.Ca=this.va=0;this.vd="#FFFFFF";this.Ib=!1;this.ib=null;this.jd={};this.Ab=[];this.nb=this.vb=this.yc=this.xc=!1;if(this.id=b)if(b=document.getElementById(b)){var h=document.documentElement.clientWidth,t=document.documentElement.clientHeight;
this.A=document.createElement("canvas");this.A.width=h;this.A.height=t;b.appendChild(this.A);if(this.T=this.A.getContext("2d")){this.T.imageSmoothingEnabled=!0;var w=window.devicePixelRatio;this.va=h;this.Ca=t;this.A.style.width=h+"px";this.A.style.height=t+"px";this.A.width=h*w;this.A.height=t*w;this.T.scale(w,w);this.S=document.createElement("div");this.S.className="textEditArea";this.S.style.visibility="hidden";this.S.contentEditable="true";this.S.style.Nb="#0000FF";h=function(B){B.stopPropagation()};
this.S.addEventListener("keydown",h);this.S.addEventListener("keypress",h);this.S.addEventListener("keyup",h);b.appendChild(this.S);this.M=document.createElement("div");this.M.className="lineTextEditArea";this.M.style.visibility="hidden";this.M.contentEditable="true";this.M.style.Nb="#0000FF";this.M.addEventListener("keydown",h);this.M.addEventListener("keypress",h);var A=this;this.M.addEventListener("keyup",function(B){A.Id();B.stopPropagation()});b.appendChild(this.M);this.ib=document.createElement("a");
this.ib.style.display="none";this.Bc()}}}a.prototype.ta=function(b){200<this.Ab.length&&this.J.splice(0,1);this.Ab.push(b)};a.prototype.Gd=function(){var b=this.Ab.length-1;if(0<=b){var h=this.Ab[b];this.Ab.splice(b,1);h.back(this);this.O=!0}};a.prototype.Id=function(){if(this.M){var b=this.M.offsetWidth-this.ob.x;0!=b&&(this.ob.x=this.M.offsetWidth,this.Sa.x-=b/2,this.M.style.left=this.Sa.x+"px");b=this.M.offsetHeight-this.ob.y;0!=b&&(this.ob.y=this.M.offsetHeight,this.Sa.y-=b/2,this.M.style.top=
this.Sa.y+"px")}};a.prototype.saveData=function(){for(var b=[],h=0;h<this.J.length;h++){var t=r.L.Db(this.J[h]);b.push(t)}this.jd.nodes=r.L.Db(b);b=[];for(h=0;h<this.lines.length;h++)t=r.L.Cb(this.lines[h]),b.push(t);this.jd.lines=r.L.Cb(b)};a.prototype.Zd=function(){if(this.A&&this.T&&this.ib){var b=this.Ib;b||(this.Ib=!0,this.qa());var h=this.A.toDataURL("image/png");this.Ib=b;this.ib.download=Date.now()+".png";this.ib.href=h;this.ib.click()}};a.prototype.Vc=function(b){if(0==b||2==b)this.sa.type=
b,this.za&&this.za.type!=b&&(this.za.type=b,this.za.ma(),this.qa())};a.prototype.ce=function(b,h){h||(h=this.lines.indexOf(b));0<=h&&h!=this.lines.length-1&&(this.lines.splice(h,1),this.lines.push(b))};a.prototype.de=function(b,h){h||(h=this.J.indexOf(b));0<=h&&h!=this.J.length-1&&(this.J.splice(h,1),this.J.push(b))};a.prototype.Ic=function(b,h,t){t||(t=h.indexOf(b));0<=t&&t!=h.length-1&&(h.splice(t,1),h.push(b))};a.prototype.Fa=function(b){0>this.J.indexOf(b)&&(this.J.push(b),this.sd(b))};a.prototype.vc=
function(b){var h=this.J.indexOf(b);0<=h&&this.J.splice(h,1);if(b instanceof z.Ba){for(var t=0;t<b.ga.length;t++)h=b.ga[t],h.u=null,h.F=null;for(t=0;t<b.ha.length;t++)h=b.ha[t],h.v=null,h.fromPoint=null}this.anchorNode==b&&(this.anchorNode=null);for(t in this.bb)if(h=this.bb[t]){var w=h.indexOf(b);0<=w&&h.splice(w,1)}};a.prototype.oc=function(b){0>this.lines.indexOf(b)&&this.lines.push(b)};a.prototype.Ad=function(b){var h=this.lines.indexOf(b);0<=h&&(this.ta(new n.Oc(b)),this.lines.splice(h,1));b.v&&
b.v.tc(b,!1);b.u&&b.u.uc(b,!1);this.za==b&&(this.za=null)};a.prototype.qa=function(){if(this.A&&this.T){this.Ib?(this.T.fillStyle=this.vd,this.T.fillRect(0,0,this.A.width,this.A.height)):this.T.clearRect(0,0,this.A.width,this.A.height);if(0<this.J.length)for(var b=0;b<this.J.length;b++){var h=this.J[b];h.show(this.T)}if(0<this.lines.length)for(b=0;b<this.lines.length;b++)h=this.lines[b],h.show(this.T)}this.O=!1};a.prototype.sd=function(b){for(var h="mouseup mousedown dragmousemove mouseenterleave unanchor anchor click dblclick".split(" "),
t=0;t<h.length;t++){var w=h[t];if(!(0>this.Ld.indexOf(w))){var A=this.bb[w];A||(A=[],this.bb[w]=A);A.push(b)}}};a.prototype.Ed=function(b){var h=this.G.x,t=this.G.y;if(this.ua)return this.ua.oa(this),this.O&&this.qa(),!0;for(var w=this.lines.length-1;-1<w;w--){var A=this.lines[w];if(A.oa(this))return this.ce(A,w),this.O&&this.qa(),!0}return 1==b.buttons&&b.type==f.ea.fd&&this.sa.v&&this.sa.fromPoint?(b=new u.mc(r.L.W(),new f.h(0,0),new f.h(h,t),this.sa.type),this.sa.v.nc(b,this.sa.fromPoint),this.oc(b),
b.pa=b.g,this.sa.v=null,this.sa.fromPoint=null,this.ua=b,this.vb=!0):!1};a.prototype.Fd=function(b){return 1==b.buttons&&"mousemove"==b.type&&this.wb&&(this.wb=!1,b=e.Fb.createNode(this.bd))?(this.Fa(b),b.mb.x=-b.w/2,b.mb.y=-b.j/2,this.xc=!0,this.Ra=b,!0):!1};a.prototype.wc=function(b){if("mousedown"==b.type)if(this.ab&&this.ab.o&&this.S){for(var h=this.S.childNodes,t=[],w=0;w<h.length;w++){var A=h[w];t.push(A.textContent?A.textContent:"")}this.ab.o.D=!0;this.ab.o.Eb(t);this.ab=null;this.S.style.visibility=
"hidden";this.O=!0}else if(this.La&&this.La.o&&this.M){h=this.M.childNodes;t=[];for(w=0;w<h.length;w++)A=h[w],t.push(A.textContent?A.textContent:"");this.La.o.D=!0;this.La.o.Eb(t);this.T&&this.La.o.cd(this.T);this.La.Fc();this.La=null;this.M.style.visibility="hidden";this.O=!0}this.G.x=1==this.Oa.x?b.offsetX:b.offsetX/this.Oa.x;this.G.y=1==this.Oa.y?b.offsetY:b.offsetY/this.Oa.y;this.Lb=b.buttons;this.Mb=b.type;if(!this.Fd(b))if(1==b.buttons&&this.Ra&&"mousemove"==b.type)this.yc||(this.yc=!0,this.ta(new n.gb(this.Ra))),
this.Ra.oa(this,f.ea.Ta),this.O&&this.qa();else if(!this.Ed(b)||"mousemove"==b.type&&this.ua){if("mousemove"==b.type)this.Kc(b);else if("mousedown"==b.type)this.Jc(b);else if(h=this.bb[b.type]){t=this.G.x;var B=this.G.y;"mouseup"==b.type&&(this.Vb(),this.sa.v=null,this.sa.fromPoint=null);for(w=h.length-1;-1<w;w--)if(A=h[w],t>A.p.x&&B>A.p.y&&t<A.p.x+A.w&&B<A.p.y+A.j){A.oa(this,"on"+b.type);this.Ic(A,h,w);break}}this.O&&this.qa()}};a.prototype.Jc=function(b){if(1==b.buttons&&(b=this.bb[b.type])){for(var h=
!1,t=this.G.x,w=this.G.y,A=b.length-1;-1<A;A--){var B=b[A];if(t>B.p.x&&w>B.p.y&&t<B.p.x+B.w&&w<B.p.y+B.j){h=!0;this.za=null;this.anchorNode?this.anchorNode!=B&&(this.anchorNode.oa(this,f.ea.Tb),this.anchorNode=B,this.anchorNode.oa(this,f.ea.Sb)):(this.anchorNode=B,this.anchorNode.oa(this,f.ea.Sb));B.oa(this,f.ea.onmousedown);this.de(B,A);this.Ic(B,b,A);break}}!h&&this.anchorNode&&(this.anchorNode.oa(this,f.ea.Tb),this.anchorNode=null)}};a.prototype.Kc=function(){var b=this.bb[f.ea.ed],h=!1;if(b){for(var t=
this.G.x,w=this.G.y,A=b.length-1;-1<A;A--){var B=b[A];if(t>B.p.x&&w>B.p.y&&t<B.p.x+B.w&&w<B.p.y+B.j){h=!0;this.ka?this.ka!=B?(this.ka.oa(this,f.ea.onmouseleave),this.ka=B,this.ka.oa(this,f.ea.onmouseenter)):this.ua||(B.oa(this,f.ea.onmousemove),this.Ic(B,b,A)):(this.ka=B,this.ka.oa(this,f.ea.onmouseenter));break}}!h&&this.ka&&(this.ka.oa(this,f.ea.onmouseleave),this.ka=null)}h||!this.A||this.A.style.cursor==f.$.default||this.ua||(this.A.style.cursor=f.$.default)};a.prototype.Cd=function(b){if(this.A)switch(b.key.toLowerCase()){case "backspace":case "delete":this.anchorNode?
(this.ta(new n.Pc(this.anchorNode)),this.vc(this.anchorNode),this.O=!0):this.za&&(this.Ad(this.za),this.O=!0)}};a.prototype.Bd=function(b){if(this.A&&this.T)switch(b.key.toLowerCase()){case "c":b.ctrlKey&&(this.anchorNode?(this.Kb=this.anchorNode,this.tb=null):(this.za?this.tb=this.za:this.tb=null,this.Kb=null));break;case "v":if(b.ctrlKey)if(this.Kb){b=this.Kb.clone();b.p.x+=5;b.p.y+=5;this.Fa(b);var h=new z.Node("-1",new f.h(0,0),1,1);h.id=b.id;this.ta(new n.lc(h));this.O=!0}else this.tb&&(b=this.tb.clone(),
b.from.x+=5,b.from.y+=5,b.g.x+=5,b.g.y+=5,b.ma(),this.oc(b),h=new u.Aa("-1",new f.h(0,0),new f.h(0,0),0),h.id=b.id,this.ta(new n.Gb(h)),this.O=!0);break;case "z":b.ctrlKey&&this.Gd();break;case "arrowdown":this.anchorNode&&this.anchorNode.p.y<this.maxHeight&&(this.ta(new n.gb(this.anchorNode)),this.anchorNode.p.y=b.shiftKey?this.anchorNode.p.y+this.Pb:this.anchorNode.p.y+this.Ob,this.anchorNode.p.y+this.anchorNode.j>this.Ca&&(b=window.devicePixelRatio,this.Ca+=100,this.A.style.height=this.Ca+"px",
this.A.height=this.Ca*b,this.T.scale(b,b)),this.anchorNode instanceof z.Ba&&this.anchorNode.jb(),this.O=!0);break;case "arrowup":this.anchorNode&&0<this.anchorNode.p.y+this.anchorNode.j&&(this.ta(new n.gb(this.anchorNode)),this.anchorNode.p.y=b.shiftKey?this.anchorNode.p.y-this.Pb:this.anchorNode.p.y-this.Ob,this.anchorNode instanceof z.Ba&&this.anchorNode.jb(),this.O=!0);break;case "arrowright":this.anchorNode&&this.anchorNode.p.x<this.maxWidth&&(this.ta(new n.gb(this.anchorNode)),this.anchorNode.p.x=
b.shiftKey?this.anchorNode.p.x+this.Pb:this.anchorNode.p.x+this.Ob,this.anchorNode.p.x+this.anchorNode.w>this.va&&(b=window.devicePixelRatio,this.va+=100,this.A.style.width=this.va+"px",this.A.width=this.va*b,this.T.scale(b,b)),this.anchorNode instanceof z.Ba&&this.anchorNode.jb(),this.O=!0);break;case "arrowleft":this.anchorNode&&0<this.anchorNode.p.x+this.anchorNode.w&&(this.ta(new n.gb(this.anchorNode)),this.anchorNode.p.x=b.shiftKey?this.anchorNode.p.x-this.Pb:this.anchorNode.p.x-this.Ob,this.anchorNode instanceof
z.Ba&&this.anchorNode.jb(),this.O=!0)}};a.prototype.Dd=function(b){"keyup"==b.type?this.Cd(b):"keydown"==b.type&&this.Bd(b);this.O&&this.qa()};a.prototype.Vb=function(){if(this.Ra){if(this.xc){this.xc=!1;var b=new z.Node("-1",new f.h(0,0),1,1);b.id=this.Ra.id;this.ta(new n.lc(b))}this.yc=!1;this.Ra=null}this.ua&&(this.ua=null,this.vb&&(this.vb=!1,b=new u.Aa("-1",new f.h(0,0),new f.h(0,0),0),b.id=this.id,this.ta(new n.Gb(b))),this.nb=!1)};a.prototype.Bc=function(){if(this.A){var b=this,h=function(t){b.wc(t);
t.stopPropagation()};this.A.onclick=h;this.A.ondblclick=h;this.A.onmousedown=h;this.A.onmouseup=h;this.A.onmousemove=h;document.addEventListener("mouseup",function(){b.Vb()});h=function(t){"f12"!=t.key.toLowerCase()&&(t.preventDefault(),b.Dd(t),t.stopPropagation())};this.A.parentElement&&(document.onkeydown=h,document.onkeyup=h)}};return a}();x.Mc=y});
define("layer/Action",["require","exports","core/base/BaseBean","core/base/Node","util/CommonUtil"],function(y,x,f,u,z){Object.defineProperty(x,"__esModule",{value:!0});x.kc=x.Gb=x.Oc=x.gb=x.lc=x.Pc=x.rd=void 0;y=function(){function n(e){this.type=e}n.prototype.back=function(){};return n}();x.rd=y;var r=function(n){function e(a){var b=n.call(this,1)||this;b.Ac=[];b.Hc=[];b.n=a;if(b.n instanceof u.Ba){a=0;for(var h=b.n.ha.length;a<h;a++){var t=b.n.ha[a];t.fromPoint&&b.Ac.push(new f.Xa(t.fromPoint.x,
t.fromPoint.y,t.fromPoint.R))}a=0;for(h=b.n.ga.length;a<h;a++)t=b.n.ga[a],t.F&&b.Hc.push(new f.Xa(t.F.x,t.F.y,t.F.R))}return b}Y(e,n);e.prototype.back=function(a){a.Fa(this.n);if(this.n instanceof u.Ba){a=this.Ac.length;for(var b=0,h=this.n.ha.length;b<h;b++){var t=this.n.ha[b];a>b&&this.n.nc(t,this.Ac[b])}a=this.Hc.length;b=0;for(h=this.n.ga.length;b<h;b++)t=this.n.ga[b],a>b&&this.n.Tc(t,this.Hc[b])}};return e}(y);x.Pc=r;r=function(n){function e(a){var b=n.call(this,11)||this;b.n=a;return b}Y(e,
n);e.prototype.back=function(a){for(var b=0,h=a.J.length;b<h;b++)if(a.J[b].id==this.n.id){a.vc(a.J[b]);break}};return e}(y);x.lc=r;r=function(n){function e(a){var b=n.call(this,12)||this;a=z.L.Db(a);b.n=a;return b}Y(e,n);e.prototype.back=function(a){for(var b,h=0,t=a.J.length;h<t;h++)if(b=a.J[h],b.id==this.n.id){z.L.qc(b,this.n);b instanceof u.Ba&&b.jb();break}};return e}(y);x.gb=r;r=function(n){function e(a){var b=n.call(this,2)||this;b.line=a;return b}Y(e,n);e.prototype.back=function(a){a.oc(this.line);
this.line.v&&this.line.fromPoint&&this.line.v.nc(this.line,this.line.fromPoint);this.line.u&&this.line.F&&this.line.u.Tc(this.line,this.line.F)};return e}(y);x.Oc=r;r=function(n){function e(a){var b=n.call(this,21)||this;b.line=a;return b}Y(e,n);e.prototype.back=function(a){for(var b=0,h=a.lines.length;b<h;b++)if(a.lines[b].id==this.line.id){a.vc(a.J[b]);break}};return e}(y);x.Gb=r;y=function(n){function e(a){var b=n.call(this,22)||this;b.v=null;b.u=null;b.v=a.v;b.u=a.u;console.log("type:"+a.type);
a=z.L.Cb(a);a.fromNode=null;a.toNode=null;b.line=a;console.log(b.line);return b}Y(e,n);e.prototype.back=function(a){console.log("back");for(var b=0,h=a.lines.length;b<h;b++)if(a.lines[b].id==this.line.id){z.L.rc(a,a.lines[b],this.line);a.lines[b].v=this.v;a.lines[b].u=this.u;console.log(a.lines[b]);break}};return e}(y);x.kc=y});
define("core/base/LinkLine","require exports core/base/BaseBean core/base/BaseShape core/base/Node layer/Action util/CommonUtil".split(" "),function(y,x,f,u,z,r,n){Object.defineProperty(x,"__esModule",{value:!0});x.mc=x.Aa=void 0;y=function(){function e(a,b,h,t,w){this.Z="21";this.m=20;this.Qa=100;this.Ua=20;this.Uc=new f.h(0,0);this.i=[];this.yb=null;this.type=0;this.lineWidth=2;this.strokeStyle="#000";this.pa=null;this.$a=-1;this.F=this.u=this.fromPoint=this.v=null;this.fa={};this.id=a;this.from=
b;this.g=h;this.type=t;this.C=new u.ac(this.g,10,14,3);this.C.N=!1;this.C.I=!0;this.$b=new f.h(this.from.x,this.from.y);this.Jb=new f.h(this.from.x,this.from.y);this.ma(w);this.ja()}e.prototype.clone=function(){return new e(n.L.W(),new f.h(this.from.x,this.from.y),new f.h(this.g.x,this.g.y),this.type)};e.prototype.Od=function(){this.i[0]||(this.i[0]=new f.h(this.from.x+(this.g.x-this.from.x)/2,this.from.y));this.i[1]||(this.i[1]=new f.h(this.i[0].x,this.g.y));var a=!1,b=!1;if(this.fromPoint&&this.v)switch(this.fromPoint.R){case 0:this.g.y>
this.from.y?(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y-this.Qa):(this.i[0].x=this.from.x,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2);a=!0;break;case 1:this.g.x<this.from.x?(this.i[0].x=this.from.x+this.Qa,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2):(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y);a=!0;break;case 2:this.g.y<this.from.y?(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y+this.Qa):(this.i[0].x=
this.from.x,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2);a=!0;break;case 3:this.g.x>this.from.x?(this.i[0].x=this.from.x-this.Qa,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2):(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y),a=!0}if(this.F&&this.u)switch(this.F.R){case 0:this.g.y<this.from.y?(this.from.x>this.g.x?this.i[1].x=this.g.x+this.u.w/2:this.i[1].x=this.g.x-this.u.w/2,this.i[1].y=this.g.y-this.Qa):(this.i[1].x=this.g.x,this.i[1].y=this.g.y+(this.from.y-this.g.y)/
2);b=!0;break;case 1:this.g.x>this.from.x?(this.i[1].x=this.g.x+this.Qa,this.from.y>this.g.y?this.i[1].y=this.g.y+this.u.w/2:this.i[1].y=this.g.y-this.u.w/2):(this.i[1].x=this.g.x+(this.from.x-this.g.x)/2,this.i[1].y=this.g.y);b=!0;break;case 2:this.g.y>this.from.y?(this.from.x>this.g.x?this.i[1].x=this.g.x+this.u.w/2:this.i[1].x=this.g.x-this.u.w/2,this.i[1].y=this.g.y+this.Qa):(this.i[1].x=this.g.x,this.i[1].y=this.g.y+(this.from.y-this.g.y)/2);b=!0;break;case 3:this.g.x<this.from.x?(this.i[1].x=
this.g.x-this.Qa,this.from.y>this.g.y?this.i[1].y=this.g.y+this.u.w/2:this.i[1].y=this.g.y-this.u.w/2):(this.i[1].x=this.g.x+(this.from.x-this.g.x)/2,this.i[1].y=this.g.y),b=!0}a||(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y);b||(this.i[1].x=this.g.x+(this.from.x-this.g.x)/2,this.i[1].y=this.g.y)};e.prototype.Qd=function(){if(this.v&&this.fromPoint)if(this.g.y<=this.from.y)if(this.F&&this.u)switch(this.F.R){case 0:var a=this.g.y-this.m;this.i.push(new f.h(this.from.x,
a));this.i.push(new f.h(this.g.x,a));break;case 1:this.from.x>=this.g.x?this.i.push(new f.h(this.from.x,this.g.y)):(a=this.u.p.y+this.u.j,a=a<this.from.y?this.from.y-Math.min(this.m,(this.from.y-a)/2):this.u.p.y-this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x+this.m,a)),this.i.push(new f.h(this.g.x+this.m,this.g.y)));break;case 2:a=this.g.y+(this.from.y-this.g.y)/2;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 3:this.from.x<=this.g.x?this.i.push(new f.h(this.from.x,
this.g.y)):(a=this.u.p.y+this.u.j,a=a<this.from.y?this.from.y-Math.min(this.m,(this.from.y-a)/2):this.u.p.y-this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x-this.m,a)),this.i.push(new f.h(this.g.x-this.m,this.g.y)))}else this.g.x>this.from.x?this.g.x-this.from.x>this.from.y-this.g.y?(this.C.K=3,this.i.push(new f.h(this.from.x,this.g.y))):(this.C.K=2,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a))):this.g.x<this.from.x?
this.from.x-this.g.x>this.from.y-this.g.y?(this.C.K=1,this.i.push(new f.h(this.from.x,this.g.y))):(this.C.K=2,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a))):this.C.K=2;else if(this.F&&this.u)switch(this.F.R){case 0:a=this.from.y-this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 1:a=this.from.y-this.m;var b=this.g.x<this.v.p.x?this.g.x+Math.min(this.m,(this.v.p.x-this.g.x)/2):Math.max(this.g.x,this.v.p.x+
this.v.w)+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(b,a));this.i.push(new f.h(b,this.g.y));break;case 2:this.from.x>=this.g.x?(b=this.u.p.x+this.u.w,this.v.p.x>b?b+=(this.v.p.x-b)/2:b=Math.min(this.u.p.x,this.v.p.x)-this.m):(b=this.v.p.x+this.v.w,b=this.u.p.x>b?b+(this.u.p.x-b)/2:Math.max(this.u.p.x+this.u.w,this.v.p.x+this.v.w)+this.m);this.i.push(new f.h(this.from.x,this.from.y-this.m));this.i.push(new f.h(b,this.from.y-this.m));this.i.push(new f.h(b,this.g.y+this.m));this.i.push(new f.h(this.g.x,
this.g.y+this.m));break;case 3:b=this.v.p.x+this.v.w,b=this.g.x<=b?Math.min(this.g.x,this.v.p.x)-this.m:this.g.x-Math.min((this.g.x-b)/2,this.m),this.i.push(new f.h(this.from.x,this.from.y-this.m)),this.i.push(new f.h(b,this.from.y-this.m)),this.i.push(new f.h(b,this.g.y))}else a=this.from.y-this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a)),this.C.K=0};e.prototype.Sd=function(){if(this.v&&this.fromPoint)if(this.g.y>=this.from.y)if(this.F&&this.u)switch(this.F.R){case 0:var a=
this.from.y+(this.g.y-this.from.y)/2;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 1:this.from.x>=this.g.x?this.i.push(new f.h(this.from.x,this.g.y)):(a=this.v.p.y+this.v.j,a=a<this.u.p.y?this.from.y+Math.min(this.m,(this.u.p.y-a)/2):this.u.p.y+this.u.j+this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x+this.m,a)),this.i.push(new f.h(this.g.x+this.m,this.g.y)));break;case 2:a=this.g.y+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,
a));break;case 3:this.from.x<=this.g.x?this.i.push(new f.h(this.from.x,this.g.y)):(a=this.v.p.y+this.v.j,a=a<this.u.p.y?this.from.y+Math.min(this.m,(this.u.p.y-a)/2):this.u.p.y+this.u.j+this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x-this.m,a)),this.i.push(new f.h(this.g.x-this.m,this.g.y)))}else this.g.x>this.from.x?this.g.x-this.from.x>this.g.y-this.from.y?(this.C.K=3,this.i.push(new f.h(this.from.x,this.g.y))):(this.C.K=0,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,
a)),this.i.push(new f.h(this.g.x,a))):this.g.x<this.from.x?this.from.x-this.g.x>this.g.y-this.from.y?(this.C.K=1,this.i.push(new f.h(this.from.x,this.g.y))):(this.C.K=0,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a))):this.C.K=0;else if(this.F&&this.u)switch(this.F.R){case 0:if(this.from.x>=this.g.x){var b=this.u.p.x+this.u.w;this.v.p.x>b?b+=(this.v.p.x-b)/2:b=Math.min(this.u.p.x,this.v.p.x)-this.m}else b=this.v.p.x+this.v.w,b=this.u.p.x>
b?b+(this.u.p.x-b)/2:Math.max(this.u.p.x+this.u.w,this.v.p.x+this.v.w)+this.m;this.i.push(new f.h(this.from.x,this.from.y+this.m));this.i.push(new f.h(b,this.from.y+this.m));this.i.push(new f.h(b,this.g.y-this.m));this.i.push(new f.h(this.g.x,this.g.y-this.m));break;case 1:a=this.from.y+this.m;b=this.g.x<this.v.p.x?this.g.x+Math.min(this.m,(this.v.p.x-this.g.x)/2):Math.max(this.g.x,this.v.p.x+this.v.w)+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(b,a));this.i.push(new f.h(b,this.g.y));
break;case 2:a=this.from.y+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 3:b=this.v.p.x+this.v.w,a=this.from.y+this.m,b=this.g.x<=b?Math.min(this.g.x,this.v.p.x)-this.m:this.g.x-Math.min((this.g.x-b)/2,this.m),this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(b,a)),this.i.push(new f.h(b,this.g.y))}else a=this.from.y+this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a)),this.C.K=2};e.prototype.Rd=function(){if(this.v&&this.fromPoint)if(this.g.y<=
this.from.y)if(this.F&&this.u)switch(this.F.R){case 0:var a=this.from.x<this.u.p.x?this.from.x+Math.min(this.m,(this.u.p.x-this.from.x)/2):Math.max(this.from.x,this.u.p.x+this.u.w)+this.m;var b=this.g.y-this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 1:a=Math.max(this.from.x,this.g.x)+this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,this.g.y));break;case 2:this.g.x>=this.from.x?this.i.push(new f.h(this.g.x,this.from.y)):
(b=this.g.y<this.v.p.y?this.g.y+Math.min((this.v.p.y-this.g.y)/2,this.m):this.v.p.y+this.v.j+this.m,a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 3:this.from.x<=this.g.x?(a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(b=this.u.p.y+this.u.j,b<this.v.p.y?b+=(this.v.p.y-b)/2:b=Math.min(this.u.p.y,this.v.p.y)-this.m,a=this.from.x+this.m,this.i.push(new f.h(a,
this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x-this.m,this.i.push(new f.h(a,b)),this.i.push(new f.h(a,this.g.y)))}else this.g.x>this.from.x?this.from.y-this.g.y>this.g.x-this.from.x?(this.C.K=2,this.i.push(new f.h(this.g.x,this.from.y))):(this.C.K=3,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)),this.C.K=1);else if(this.F&&this.u)switch(this.F.R){case 0:this.from.x<=
this.g.x?this.i.push(new f.h(this.g.x,this.from.y)):(b=this.v.p.y+this.v.j,b=b<this.g.y?this.g.y-Math.min(this.m,(this.g.y-b)/2):this.v.p.y-this.m,a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 1:a=Math.max(this.g.x,this.from.x)+this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,this.g.y));break;case 2:a=this.from.x<this.u.p.x?this.from.x+Math.min(this.m,(this.u.p.x-this.from.x)/2):Math.max(this.from.x,
this.u.p.x+this.u.w)+this.m;b=this.g.y+this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 3:this.from.x<=this.g.x?(a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(b=this.v.p.y+this.v.j,b=b<this.u.p.y?b+(this.u.p.y-b)/2:Math.min(this.u.p.y+this.u.j,this.v.p.y+this.v.j)+this.m,a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x-this.m,
this.i.push(new f.h(a,b)),this.i.push(new f.h(a,this.g.y)))}else this.g.x>this.from.x?this.g.y-this.from.y>this.g.x-this.from.x?(this.C.K=0,this.i.push(new f.h(this.g.x,this.from.y))):(this.C.K=3,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)),this.C.K=1)};e.prototype.Td=function(){if(this.v&&this.fromPoint)if(this.g.y<=this.from.y)if(this.F&&this.u)switch(this.F.R){case 0:var a=
this.u.p.x+this.u.w;a=this.from.x>a?this.from.x-Math.min(this.m,(this.from.x-a)/2):Math.min(this.from.x,this.u.p.x)-this.m;var b=this.g.y-this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 1:this.from.x>this.g.x?(a=this.g.x+(this.from.x-this.g.x)/2,this.i.push(new f.h(a,this.from.y))):(b=this.u.p.y+this.u.j,b=b<this.v.p.y?b+(this.v.p.y-b)/2:Math.max(this.u.p.y+this.u.j,this.v.p.y+this.v.j)+this.m,a=this.from.x-this.m,this.i.push(new f.h(a,
this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x+this.m,this.i.push(new f.h(a,b)));this.i.push(new f.h(a,this.g.y));break;case 2:this.g.x<=this.from.x?this.i.push(new f.h(this.g.x,this.from.y)):(b=this.g.y<this.v.p.y?this.g.y+Math.min((this.v.p.y-this.g.y)/2,this.m):this.v.p.y+this.v.j+this.m,a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 3:a=Math.min(this.from.x,this.g.x)-this.m,this.i.push(new f.h(a,this.from.y)),
this.i.push(new f.h(a,this.g.y))}else this.g.x<this.from.x?this.from.y-this.g.y>this.from.x-this.g.x?(this.C.K=2,this.i.push(new f.h(this.g.x,this.from.y))):(this.C.K=1,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)),this.C.K=3);else if(this.F&&this.u)switch(this.F.R){case 0:this.from.x>=this.g.x?this.i.push(new f.h(this.g.x,this.from.y)):(b=this.v.p.y+
this.v.j,b=b<this.g.y?this.g.y-Math.min(this.m,(this.g.y-b)/2):this.v.p.y-this.m,a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 1:this.from.x>this.g.x?(a=this.g.x+(this.from.x-this.g.x)/2,this.i.push(new f.h(a,this.from.y))):(b=this.v.p.y+this.v.j,b<this.u.p.y?b+=(this.u.p.y-b)/2:b=Math.min(this.u.p.y,this.v.p.y)-this.m,a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x+this.m,
this.i.push(new f.h(a,b)));this.i.push(new f.h(a,this.g.y));break;case 2:a=this.u.p.x+this.u.w;a=this.from.x>a?this.from.x-Math.min(this.m,(this.from.x-a)/2):Math.min(this.from.x,this.u.p.x)-this.m;b=this.g.y+this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 3:a=Math.min(this.from.x,this.g.x)-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))}else this.g.x<this.from.x?this.g.y-this.from.y>this.from.x-this.g.x?
(this.C.K=0,this.i.push(new f.h(this.g.x,this.from.y))):(this.C.K=1,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)),this.C.K=3)};e.prototype.Pd=function(){this.i.length=0;if(this.fromPoint&&this.v)switch(this.fromPoint.R){case 0:this.Qd();break;case 1:this.Rd();break;case 2:this.Sd();break;case 3:this.Td()}else if(this.F&&this.u)switch(this.F.R){case 0:if(this.g.y>
this.from.y)this.from.x!=this.g.x&&this.i.push(new f.h(this.g.x,this.from.y));else{var a=this.g.y-this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a))}break;case 1:this.g.x<this.from.x?this.from.y!=this.g.y&&this.i.push(new f.h(this.from.x,this.g.y)):(a=this.g.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)));break;case 2:this.g.y<this.from.y?this.from.x!=this.g.x&&this.i.push(new f.h(this.g.x,this.from.y)):(a=this.g.y+this.m,this.i.push(new f.h(this.from.x,
a)),this.i.push(new f.h(this.g.x,a)));break;case 3:this.g.x>this.from.x?this.from.y!=this.g.y&&this.i.push(new f.h(this.from.x,this.g.y)):(a=this.g.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)))}else this.from.x!=this.g.x&&this.from.y!=this.g.y&&(a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)))};e.prototype.ma=function(a){if(a)this.i=a;else switch(this.type){case 0:this.Pd();break;case 2:this.Od();break;case 3:this.i[0]?
(this.i[0].x=this.from.x,this.i[0].y=this.g.y):this.i[0]=new f.h(this.from.x,this.g.y)}this.Xd()};e.prototype.Xd=function(){for(var a=[this.from.x,this.g.x],b=[this.from.y,this.g.y],h=0;h<this.i.length;h++){var t=this.i[h];a.push(t.x);b.push(t.y)}this.$b.x=Math.min.apply(null,a);this.$b.y=Math.min.apply(null,b);this.Jb.x=Math.max.apply(null,a);this.Jb.y=Math.max.apply(null,b)};e.prototype.show=function(a){a.lineWidth=this.lineWidth;a.strokeStyle=this.strokeStyle;switch(this.type){case 0:var b=this.g.x,
h=this.g.y;switch(this.C.K){case 1:b+=this.C.j;break;case 2:h+=this.C.j;break;case 3:b-=this.C.j;break;default:h-=this.C.j}a.beginPath();a.moveTo(this.from.x,this.from.y);if(0<this.i.length)for(var t=0;t<this.i.length;t++){var w=this.i[t];a.lineTo(w.x,w.y)}a.lineTo(b,h);this.yb=null;a.stroke();a.closePath();break;case 2:if(1<this.i.length){h=this.g.x;t=this.g.y;switch(this.C.K){case 1:h+=this.C.j;break;case 2:t+=this.C.j;break;case 3:h-=this.C.j;break;default:t-=this.C.j}b=new Path2D;b.moveTo(this.from.x,
this.from.y);b.bezierCurveTo(this.i[0].x,this.i[0].y,this.i[1].x,this.i[1].y,h,t);this.yb=b;a.stroke(b)}break;case 3:if(0<this.i.length){h=this.g.x;t=this.g.y;switch(this.C.K){case 1:h+=this.C.j;break;case 2:t+=this.C.j;break;case 3:h-=this.C.j;break;default:t-=this.C.j}b=new Path2D;b.moveTo(this.from.x,this.from.y);b.quadraticCurveTo(this.i[0].x,this.i[0].y,h,t);this.yb=b;a.stroke(b)}}this.C.qa(a,this.Uc)};e.prototype.onclick=function(a){var b=!1;a.Ub?(a.za=this,a.anchorNode&&a.anchorNode instanceof
z.Ba&&(a.anchorNode.nd(),a.O=!0,a.anchorNode=null),b=!0):a.za=null;return b};e.prototype.ondblclick=function(){return!1};e.prototype.onmousedown=function(a){if(!a.A||!a.T)return!1;var b=a.G.x,h=a.G.y,t=!1;Math.abs(b-this.from.x)<this.Ua&&Math.abs(h-this.from.y)<this.Ua?(this.pa=this.from,t=!0):Math.abs(b-this.g.x)<this.Ua&&Math.abs(h-this.g.y)<this.Ua&&(this.pa=this.g,t=!0);if(t)return a.ua=this,!0;a.ua==this&&(a.ua=null);this.pa=null;return!1};e.prototype.onmouseup=function(a){var b=!1;if(a.ua==
this){if(this.pa){if(this.pa==this.from||this.pa==this.g){b=a.G.x;for(var h=a.G.y,t=!1,w=a.J.length-1;-1<w;w--){var A=a.J[w];if(A instanceof z.Ba)for(var B=0;B<A.ia.length;B++){var D=A.ia[B];if(Math.abs(A.p.x+D.l.x-b)<D.kb&&Math.abs(A.p.y+D.l.y-h)<D.kb){t=!0;this.pa==this.from?A.Rc(this,D.l,D.R):A.Sc(this,D.l,D.R);break}}}t||(this.pa==this.from?this.v&&(this.v.tc(this),this.ma()):this.u&&(this.u.uc(this),this.ma()));a.O=!0}a.vb&&(a.vb=!1,b=new e("-1",new f.h(0,0),new f.h(0,0),0),b.id=this.id,a.ta(new r.Gb(b)))}b=
!0}a.nb=!1;this.pa=null;this.$a=-1;a.ua=null;a.sa.v=null;a.sa.fromPoint=null;return b};e.prototype.Ta=function(a){var b=a.G.x,h=a.G.y;return 1==a.Lb&&this.pa?(a.nb||(a.nb=!0,a.ta(new r.kc(this))),this.pa.x=b,this.pa.y=h,this.pa!=this.g&&this.u||(1==this.C.K&&this.g.x>this.from.x?this.C.K=3:3==this.C.K&&this.g.x<this.from.x&&(this.C.K=1)),this.ma(),a.O=!0):!1};e.prototype.Nd=function(a){var b=a.G.x,h=a.G.y;if(1==a.Lb&&-1<this.$a&&this.$a<this.i.length){a.nb||(a.nb=!0,a.ta(new r.kc(this)));var t=this.i[this.$a],
w=this.i[this.$a+1];t.x==w.x?(t.x=b,w.x=b):(t.y=h,w.y=h);a.O=!0}};e.prototype.onmousemove=function(a){if(!a.A||!a.T)return!1;var b=a.G.x,h=a.G.y,t=!1;Math.abs(b-this.from.x)<this.Ua&&Math.abs(h-this.from.y)<this.Ua?t=!0:Math.abs(b-this.g.x)<this.Ua&&Math.abs(h-this.g.y)<this.Ua&&(t=!0);if(t)a.A.style.cursor!=f.$.move&&(a.A.style.cursor=f.$.move);else{var w=!0;if(0==this.type){b=this.from;if(0<this.i.length)for(h=0;h<this.i.length;h++){var A=this.i[h];if(t=this.dd(a.G,b,A)){b!=this.from&&(this.$a=
h-1,w=!1,b.x==A.x?a.A.style.cursor!=f.$.qd&&(a.A.style.cursor=f.$.qd):a.A.style.cursor!=f.$.od&&(a.A.style.cursor=f.$.od));break}b=A}t||(t=this.dd(a.G,b,this.g))}else 2==this.type&&(A=window.devicePixelRatio,this.yb&&a.T.isPointInStroke(this.yb,b*A,h*A)&&(t=!0));t&&w&&a.A.style.cursor!=f.$.md&&(a.A.style.cursor=f.$.md)}t?a.Ub=this:a.Ub=null;return t};e.prototype.dd=function(a,b,h){var t;void 0===t&&(t=3);var w=!1;if(b.x!=h.x){var A=Math.min(b.x,h.x),B=Math.max(b.x,h.x);if(a.x>=A&&a.x<=B){var D=b.y;
if(b.y!=h.y){var H=A==b.x?b:h;b=H==b?h:b;D=(a.x-H.x)*(b.y-H.y)/(b.x-H.x);D=H.y+D}a.x>=A&&a.x<=B&&Math.abs(a.y-D)<=t&&(w=!0)}}else b.y!=h.y&&(A=Math.min(b.y,h.y),B=Math.max(b.y,h.y),a.y>=A&&a.y<=B&&Math.abs(a.x-b.x)<=t&&(w=!0));return w};e.prototype.oa=function(a){if(1==a.Lb&&a.Mb==f.ea.fd){if(this.pa)return this.Ta(a),!0;if(-1<this.$a)return this.Nd(a),!0}if(a.Mb==f.ea.gd)return this.onmouseup(a);var b=a.G.x,h=a.G.y;return b>=this.$b.x&&h>=this.$b.y&&b<=this.Jb.x&&h<=this.Jb.y&&(b=this.fa["on"+a.Mb])?
b.call(this,a):!1};e.prototype.ja=function(){this.fa.onclick=this.onclick;this.fa.ondblclick=this.ondblclick;this.fa.onmousedown=this.onmousedown;this.fa.onmouseup=this.onmouseup;this.fa.onmousemove=this.onmousemove;this.fa.ondragmousemove=this.Ta};return e}();x.Aa=y;y=function(e){function a(b,h,t,w,A){b=e.call(this,b,h,t,w,A)||this;b.Z="22";b.o=new u.Hb(null,new f.h(0,0),[],80);b.o.sc=!1;b.o.Jd=!0;b.o.fillStyle="#9966FF";b.o.strokeStyle="#9966FF";return b}Y(a,e);a.prototype.ondblclick=function(b){if(b.Ub!=
this)return!1;this.Fc();if(b.M){b.M.textContent="";if(0<this.o.text.length)for(var h=0;h<this.o.text.length;h++){var t=this.o.text[h],w=document.createElement("div");t?w.textContent=t:w.innerHTML="<br>";b.M.appendChild(w)}b.Sa.x=this.o.l.x;b.Sa.y=this.o.l.y;b.M.style.top=this.o.l.y+"px";b.M.style.left=this.o.l.x+"px";b.M.style.fontSize=this.o.fontSize+"px";b.M.style.fontFamily=this.o.fontFamily;b.M.style.color=this.o.fillStyle;b.M.style.visibility="visible";b.M.focus();if(h=window.getSelection())h.selectAllChildren(b.M),
h.collapseToEnd();this.o.D=!1;b.La=this;b.ab=null;b.O=!0;b.ob.x=b.M.offsetWidth;b.ob.y=b.M.offsetHeight;return!0}return!1};a.prototype.ma=function(b){e.prototype.ma.call(this,b);this.o&&0<this.o.text.length&&this.Fc()};a.prototype.Fc=function(){if(this.o)switch(this.type){case 0:this.Wd();break;case 2:this.Ud()}};a.prototype.Wd=function(){if(0==this.i.length)this.from.x==this.g.x?(this.o.l.x=this.from.x,this.o.l.y=this.from.y+(this.g.y-this.from.y)/2):(this.o.l.y=this.from.y,this.o.l.x=this.from.x+
(this.g.x-this.from.x)/2);else{for(var b=this.from,h=0,t=[],w=0,A=this.i.length;w<A;w++){var B=this.i[w];h=B.x==b.x?h+Math.abs(B.y-b.y):h+Math.abs(B.x-b.x);t[w]=h;b=B}h=this.g.x==b.x?h+Math.abs(this.g.y-b.y):h+Math.abs(this.g.x-b.x);h/=2;b=0;for(A=t.length;b<A&&!(t[b]>h);b++);0==b?(A=this.from,w=this.i[0]):(A=this.i[b-1],w=b<this.i.length?this.i[b]:this.g,h-=t[b-1]);A.x==w.x?(this.o.l.x=A.x,w.y>A.y?this.o.l.y=A.y+h:this.o.l.y=A.y-h):(this.o.l.y=A.y,w.x>A.x?this.o.l.x=A.x+h:this.o.l.x=A.x-h);this.o.l.x-=
this.o.Ma/2;this.o.l.y-=this.o.Qb/2}};a.prototype.Ud=function(){var b=this.g.x,h=this.g.y;switch(this.C.K){case 1:b+=this.C.j;break;case 2:h+=this.C.j;break;case 3:b-=this.C.j;break;default:h-=this.C.j}this.o.l.x=.125*this.from.x+.375*this.i[0].x+.375*this.i[1].x+.125*b;this.o.l.y=.125*this.from.y+.375*this.i[0].y+.375*this.i[1].y+.125*h;this.o.l.x-=this.o.Ma/2;this.o.l.y-=this.o.Qb/2};a.prototype.show=function(b){e.prototype.show.call(this,b);this.o&&this.o.D&&0<this.o.text.length&&this.o.qa(b,this.Uc)};
a.prototype.clone=function(){var b=new a(n.L.W(),new f.h(this.from.x,this.from.y),new f.h(this.g.x,this.g.y),this.type);b.o.Eb(this.o.text.slice(0));return b};return a}(y);x.mc=y});
define("core/base/Node",["require","exports","core/base/BaseBean","core/base/BaseShape","util/CommonUtil"],function(y,x,f,u,z){Object.defineProperty(x,"__esModule",{value:!0});x.Ya=x.Ba=x.Node=void 0;y=function(){function r(n,e,a,b){this.Z="1";this.mb=new f.h(0,0);this.zb=new f.h(0,0);this.pb=[];this.fa={};this.id=n;this.p=e;this.w=a;this.j=b;this.ja()}r.prototype.td=function(n){this.pb.push(n)};r.prototype.hb=function(n){this.pb.splice(0,0,n)};r.prototype.show=function(n){if(this.pb)for(var e=0;e<
this.pb.length;e++)this.pb[e].D&&this.pb[e].qa(n,this.p)};r.prototype.oa=function(n,e){(e=this.fa[e])&&e.call(this,n)};r.prototype.onmousedown=function(n){var e=n.G.x,a=n.G.y;this.zb.x=e;this.zb.y=a;this.mb.x=this.p.x-e;this.mb.y=this.p.y-a;n.Ra=this};r.prototype.Ta=function(n){var e=n.G.y;this.p.x=n.G.x+this.mb.x;this.p.y=e+this.mb.y;n.O=!0};r.prototype.scale=function(n,e){this.w=n;this.j=e};r.prototype.ja=function(){this.fa.onmousedown=this.onmousedown;this.fa.ondragmousemove=this.Ta};r.prototype.clone=
function(){return new r(z.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j)};return r}();x.Node=y;y=function(r){function n(e,a,b,h){e=r.call(this,e,a,b,h)||this;e.he=4;e.Wb=6;e.Xb=.5*e.Wb;e.Yb=1.5*e.Wb;e.Bb="#990000";e.Na=[];e.ia=[];e.Y="#FF3300";e.X=4;e.Ga=0;e.na=20;e.ha=[];e.ga=[];e.eb=new f.h(1,1);a=e.Wb;e.lb=new u.Rect(new f.h(0,0),e.w,e.j,e.Bb);e.Va=new u.Rect(new f.h(-a/2,-a/2),a,a,e.Bb);e.Pa=new u.Rect(new f.h(b-a/2,-a/2),a,a,e.Bb);e.Ja=new u.Rect(new f.h(-a/2,h-a/2),a,a,e.Bb);e.Ka=new u.Rect(new f.h(b-
a/2,h-a/2),a,a,e.Bb);e.lb.I=!1;e.lb.D=!1;e.Va.I=!0;e.Va.D=!1;e.Va.fillStyle="#FFFFFF";e.Pa.I=!0;e.Pa.D=!1;e.Pa.fillStyle="#FFFFFF";e.Ja.I=!0;e.Ja.D=!1;e.Ja.fillStyle="#FFFFFF";e.Ka.I=!0;e.Ka.D=!1;e.Ka.fillStyle="#FFFFFF";e.Na.push(e.lb);e.Na.push(e.Va);e.Na.push(e.Pa);e.Na.push(e.Ja);e.Na.push(e.Ka);return e}Y(n,r);n.prototype.clone=function(){return new n(z.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j)};n.prototype.nc=function(e,a){this.Rc(e,a,a.R)};n.prototype.Rc=function(e,a,b){void 0===b&&(b=
0);e.v&&e.v==this||(e.v&&e.v.tc(e),e.v=this);e.fromPoint=new f.Xa(a.x,a.y,b);e.from.x=this.p.x+a.x;e.from.y=this.p.y+a.y;e.ma();0>this.ha.indexOf(e)&&this.ha.push(e)};n.prototype.tc=function(e,a){void 0===a&&(a=!0);a&&(e.fromPoint=null,e.v=null);e=this.ha.indexOf(e);0<=e&&this.ha.splice(e,1)};n.prototype.Tc=function(e,a){this.Sc(e,a,a.R)};n.prototype.Sc=function(e,a,b){void 0===b&&(b=0);e.u&&e.u==this||(e.u&&e.u.uc(e),e.u=this);e.F=new f.Xa(a.x,a.y,b);e.g.x=this.p.x+a.x;e.g.y=this.p.y+a.y;e.C.K=b;
e.ma();0>this.ga.indexOf(e)&&this.ga.push(e)};n.prototype.uc=function(e,a){void 0===a&&(a=!0);a&&(e.F=null,e.u=null);e=this.ga.indexOf(e);0<=e&&this.ga.splice(e,1)};n.prototype.show=function(e){r.prototype.show.call(this,e);if(this.Na)for(var a=0;a<this.Na.length;a++)this.Na[a].D&&this.Na[a].qa(e,this.p);if(this.ia)for(a=0;a<this.ia.length;a++)this.ia[a].D&&this.ia[a].qa(e,this.p)};n.prototype.qb=function(e){e&&0<e.length&&(this.ia=e)};n.prototype.onmouseenter=function(e){e.anchorNode!=this&&(this.$c(),
e.O=!0)};n.prototype.onmouseleave=function(e){e.anchorNode!=this&&(this.ad(),e.O=!0)};n.prototype.Tb=function(e){this.nd();this.ad();e.O=!0};n.prototype.Sb=function(e){this.$d();this.$c();e.O=!0};n.prototype.onmousemove=function(e){if(e.A){this.Ga=0;var a=e.G.x-this.p.x,b=e.G.y-this.p.y;if(a>this.Ka.l.x-this.Xb&&b>this.Ka.l.y-this.Xb)this.Ga=3,e.A.style.cursor!=f.$.Zb&&(e.A.style.cursor=f.$.Zb);else if(a<this.Va.l.x+this.Yb&&b<this.Va.l.y+this.Yb)this.Ga=1,e.A.style.cursor!=f.$.Zb&&(e.A.style.cursor=
f.$.Zb);else if(a>this.Pa.l.x-this.Xb&&b<this.Pa.l.y+this.Yb)this.Ga=2,e.A.style.cursor!=f.$.Rb&&(e.A.style.cursor=f.$.Rb);else if(a<this.Ja.l.x+this.Yb&&b>this.Ja.l.y-this.Xb)this.Ga=4,e.A.style.cursor!=f.$.Rb&&(e.A.style.cursor=f.$.Rb);else if(0<this.ia.length)for(var h=0;h<this.ia.length;h++){var t=this.ia[h];if(Math.abs(a-t.l.x)<t.kb&&Math.abs(b-t.l.y)<t.kb){this.Ga=5;e.A.style.cursor!=f.$.Zc&&(e.A.style.cursor=f.$.Zc);break}}0==this.Ga&&e.A.style.cursor!=f.$.move&&(e.A.style.cursor=f.$.move)}};
n.prototype.onmousedown=function(e){var a=e.G.x-this.p.x,b=e.G.y-this.p.y;if(0<this.ia.length)for(var h=0;h<this.ia.length;h++){var t=this.ia[h];if(Math.abs(a-t.l.x)<t.kb&&Math.abs(b-t.l.y)<t.kb){e.sa.v=this;e.sa.fromPoint=new f.Xa(t.l.x,t.l.y,t.R);return}}r.prototype.onmousedown.call(this,e)};n.prototype.Ta=function(e){0==this.Ga?(r.prototype.Ta.call(this,e),this.jb()):5>this.Ga&&this.ae(e.G,this.zb)&&(this.zb.x=e.G.x,this.zb.y=e.G.y,e.O=!0)};n.prototype.$d=function(){this.lb.D=!0;this.Va.D=!0;this.Pa.D=
!0;this.Ja.D=!0;this.Ka.D=!0};n.prototype.nd=function(){this.lb.D=!1;this.Va.D=!1;this.Pa.D=!1;this.Ja.D=!1;this.Ka.D=!1};n.prototype.$c=function(){for(var e=0;e<this.ia.length;e++)this.ia[e].D=!0};n.prototype.ad=function(){for(var e=0;e<this.ia.length;e++)this.ia[e].D=!1};n.prototype.ae=function(e,a){switch(this.Ga){case 1:var b=e.x;e=e.y;if(b>this.p.x+this.w-this.na||e>this.p.y+this.j-this.na)return!1;var h=b-a.x,t=e-a.y;this.p.x+=h;this.p.y+=t;h=this.w-h;t=this.j-t;if(h<this.na||t<this.na)return!1;
this.scale(h,t);break;case 2:b=e.x;e=e.y;if(b<this.p.x+this.na||e>this.p.y+this.j-this.na)return!1;t=e-a.y;this.p.y+=t;h=this.w+b-a.x;t=this.j-t;a.x=b;a.y=e;if(h<this.na||t<this.na)return!1;this.scale(h,t);break;case 3:b=e.x;e=e.y;if(b<this.p.x+this.na||e<this.p.y+this.na)return!1;h=this.w+b-a.x;t=this.j+e-a.y;a.x=b;a.y=e;if(h<this.na||t<this.na)return!1;this.scale(h,t);break;case 4:b=e.x;e=e.y;if(b>this.p.x+this.w-this.na||e<this.p.y+this.na)return!1;h=b-a.x;this.p.x+=h;h=this.w-h;t=this.j+e-a.y;
a.x=b;a.y=e;if(h<this.na||t<this.na)return!1;this.scale(h,t);break;default:return!1}return!0};n.prototype.scale=function(e,a){this.eb.x=e/this.w;this.eb.y=a/this.j;r.prototype.scale.call(this,e,a);e=this.Wb;this.lb.scale(this.w,this.j,!1);this.Pa.P(this.w-e/2,-e/2);this.Ja.P(-e/2,this.j-e/2);this.Ka.P(this.w-e/2,this.j-e/2);0<this.ia.length&&this.Za();this.pc()};n.prototype.jb=function(){if(0<this.ha.length)for(var e=0;e<this.ha.length;e++){var a=this.ha[e];a.fromPoint&&(a.from.x=this.p.x+a.fromPoint.x,
a.from.y=this.p.y+a.fromPoint.y,a.ma())}if(0<this.ga.length)for(e=0;e<this.ga.length;e++)a=this.ga[e],a.F&&(a.g.x=this.p.x+a.F.x,a.g.y=this.p.y+a.F.y,a.ma())};n.prototype.pc=function(){if(0<this.ha.length)for(var e=0;e<this.ha.length;e++){var a=this.ha[e];a.fromPoint&&(a.fromPoint.x*=this.eb.x,a.fromPoint.y*=this.eb.y,a.from.x=this.p.x+a.fromPoint.x,a.from.y=this.p.y+a.fromPoint.y,a.ma())}if(0<this.ga.length)for(e=0;e<this.ga.length;e++)a=this.ga[e],a.F&&(a.F.x*=this.eb.x,a.F.y*=this.eb.y,a.g.x=this.p.x+
a.F.x,a.g.y=this.p.y+a.F.y,a.ma())};n.prototype.Za=function(){};n.prototype.ja=function(){r.prototype.ja.call(this);this.fa.onmouseenter=this.onmouseenter;this.fa.onmouseleave=this.onmouseleave;this.fa.onunanchor=this.Tb;this.fa.onanchor=this.Sb;this.fa.onmousemove=this.onmousemove};return n}(y);x.Ba=y;y=function(r){function n(e,a,b,h,t){e=r.call(this,e,a,b,h)||this;e.o=new u.Hb(e,new f.h(0,0),t?t:[],e.w);e.o.I=!0;e.o.N=!1;e.o.fillStyle="#000000";e.td(e.o);return e}Y(n,r);n.prototype.clone=function(){return new n(z.L.W(),
new f.h(this.p.x,this.p.y),this.w,this.j,this.o?this.o.text.slice(0):[])};n.prototype.Eb=function(e){var a;null===(a=this.o)||void 0===a?void 0:a.Eb(e)};n.prototype.scale=function(e,a){r.prototype.scale.call(this,e,a);this.o&&this.o.scale(this.o.w*this.eb.x)};n.prototype.ondblclick=function(e){if(e.S){if(0<this.o.text.length){e.S.textContent="";for(var a=0;a<this.o.text.length;a++){var b=this.o.text[a],h=document.createElement("div");b?h.textContent=b:h.innerHTML="<br>";e.S.appendChild(h)}}else e.S.textContent=
"";e.S.style.top=this.p.y+this.o.l.y+"px";e.S.style.left=this.p.x+"px";e.S.style.width=this.o.w+"px";e.S.style.minHeight=this.j-this.o.l.y+"px";e.S.style.fontSize=this.o.fontSize+"px";e.S.style.fontFamily=this.o.fontFamily;e.S.style.visibility="visible";e.S.focus();if(a=window.getSelection())a.selectAllChildren(e.S),a.collapseToEnd();this.o.D=!1;e.ab=this;e.La=null;e.O=!0}};return n}(y);x.Ya=y});
define("core/base/BaseShape",["require","exports","core/base/Pen"],function(y,x,f){Object.defineProperty(x,"__esModule",{value:!0});x.Hb=x.V=x.Lc=x.hc=x.cc=x.Rect=x.rb=x.Qc=x.ac=void 0;y=function(u){function z(r,n,e,a){void 0===a&&(a=0);var b=u.call(this)||this;b.wa=[5,5];b.ya=[];b.xa=!1;b.K=0;b.Z="32";b.w=n;b.j=e;b.Wa=n/2;b.ge=e/2;b.l=r;b.K=a;return b}Y(z,u);z.prototype.show=function(r,n){if(r&&(this.I||this.N)){r.beginPath();r.lineCap="square";this.xa?r.setLineDash(this.wa):r.setLineDash(this.ya);
switch(this.K){case 1:var e=this.l.y+this.Wa;var a=this.l.x+this.j;var b=this.l.y-this.Wa;var h=this.l.x+this.j;break;case 2:e=this.l.y+this.j;a=this.l.x+this.Wa;b=this.l.y+this.j;h=this.l.x-this.Wa;break;case 3:e=this.l.y+this.Wa;a=this.l.x-this.j;b=this.l.y-this.Wa;h=this.l.x-this.j;break;default:e=this.l.y-this.j,a=this.l.x-this.Wa,b=this.l.y-this.j,h=this.l.x+this.Wa}r.moveTo(n.x+this.l.x,n.y+this.l.y);r.lineTo(n.x+a,n.y+e);r.lineTo(n.x+h,n.y+b);r.closePath();this.I&&r.fill();this.N&&r.stroke()}};
return z}(f.Ha);x.ac=y;y=function(u){function z(r,n,e){var a=u.call(this)||this;a.wa=[5,5];a.ya=[];a.xa=!1;a.Z="33";a.l=r;a.kd=n;a.ld=e;return a}Y(z,u);z.prototype.show=function(r,n){r&&(this.I||this.N)&&(r.beginPath(),r.lineCap="square",this.xa?r.setLineDash(this.wa):r.setLineDash(this.ya),r.moveTo(n.x+this.l.x,n.y+this.l.y),r.lineTo(n.x+this.kd.x,n.y+this.kd.y),r.lineTo(n.x+this.ld.x,n.y+this.ld.y),this.I&&r.fill(),this.N&&r.stroke(),r.closePath())};return z}(f.Ha);x.Qc=y;y=function(u){function z(r){var n=
u.call(this)||this;n.wa=[5,5];n.ya=[];n.xa=!1;n.H=[];n.lineCap="square";n.lineJoin="miter";n.Z="34";n.H=r;return n}Y(z,u);z.prototype.show=function(r,n){if(r&&(this.I||this.N)&&this.H&&1<this.H.length){r.beginPath();r.lineCap=this.lineCap;r.lineJoin=this.lineJoin;this.xa?r.setLineDash(this.wa):r.setLineDash(this.ya);for(var e=0,a=this.H.length;e<a;e++)0==e?r.moveTo(n.x+this.H[0].x,n.y+this.H[0].y):r.lineTo(n.x+this.H[e].x,n.y+this.H[e].y),e+2<a&&1==this.H[e].type&&1==this.H[e+1].type&&1==this.H[e+
2].type&&(e+3<a&&1==this.H[e+3].type?(r.bezierCurveTo(n.x+this.H[e+1].x,n.y+this.H[e+1].y,n.x+this.H[e+2].x,n.y+this.H[e+2].y,n.x+this.H[e+3].x,n.y+this.H[e+3].y),e+=3):(r.quadraticCurveTo(n.x+this.H[e+1].x,n.y+this.H[e+1].y,n.x+this.H[e+2].x,n.y+this.H[e+2].y),e+=2));this.I&&r.fill();this.N&&r.stroke();r.closePath()}};return z}(f.Ha);x.rb=y;y=function(u){function z(r,n,e,a){var b=u.call(this)||this;b.wa=[5,5];b.ya=[];b.xa=!1;b.Z="35";b.l=r;b.w=n;b.j=e;a&&(b.strokeStyle=a);return b}Y(z,u);z.prototype.show=
function(r,n){r&&(this.I||this.N)&&this.l&&this.w&&this.j&&(r.beginPath(),r.lineCap="square",this.xa?r.setLineDash(this.wa):r.setLineDash(this.ya),this.I&&r.fillRect(n.x+this.l.x,n.y+this.l.y,this.w,this.j),this.N&&r.strokeRect(n.x+this.l.x,n.y+this.l.y,this.w,this.j),r.closePath())};z.prototype.scale=function(r,n,e){void 0===e&&(e=!0);e?(this.w=this.w*r,this.j=this.j*n):(this.w=r,this.j=n)};z.prototype.P=function(r,n){this.l.x=r;this.l.y=n};return z}(f.Ha);x.Rect=y;y=function(u){function z(r,n,e,
a){var b=u.call(this)||this;b.U=0;b.wa=[5,5];b.ya=[];b.xa=!1;b.Z="36";b.l=r;b.w=n;b.j=e;r=Math.min(n,e);a&&a<r&&(b.U=a);0>=b.U&&(b.U=r/3);return b}Y(z,u);z.prototype.show=function(r,n){if(r&&(this.I||this.N)&&this.l&&this.w&&this.j){r.beginPath();r.lineCap="round";this.xa?r.setLineDash(this.wa):r.setLineDash(this.ya);var e=n.x+this.l.x;n=n.y+this.l.y;r.moveTo(e+this.U,n);r.lineTo(e+this.w-this.U,n);r.quadraticCurveTo(e+this.w,n,e+this.w,n+this.U);r.lineTo(e+this.w,n+this.j-this.U);r.quadraticCurveTo(e+
this.w,n+this.j,e+this.w-this.U,n+this.j);r.lineTo(e+this.U,n+this.j);r.quadraticCurveTo(e,n+this.j,e,n+this.j-this.U);r.lineTo(e,n+this.U);r.quadraticCurveTo(e,n,e+this.U,n);this.I&&r.fill();this.N&&r.stroke();r.closePath()}};z.prototype.scale=function(r,n,e,a){void 0===e&&(e=!0);e?(this.w=this.w*r,this.j=this.j*n,a&&(this.U=this.U*a)):(this.w=r,this.j=n,a&&(this.U=a))};z.prototype.P=function(r,n){this.l.x=r;this.l.y=n};return z}(f.Ha);x.cc=y;y=function(u){function z(r,n,e,a,b,h,t){void 0===e&&(e=
0);void 0===a&&(a=2*Math.PI);void 0===b&&(b=0);var w=u.call(this)||this;w.wa=[5,5];w.ya=[];w.xa=!1;w.Z="37";w.l=r;w.U=n;w.Gc=e;w.zc=a;w.rotation=b;h&&(w.strokeStyle=h);t&&(w.lineWidth=t);return w}Y(z,u);z.prototype.show=function(r,n){r&&(this.I||this.N)&&(r.beginPath(),r.lineCap="round",this.xa?r.setLineDash(this.wa):r.setLineDash(this.ya),r.ellipse(n.x+this.l.x,n.y+this.l.y,this.U.x,this.U.y,this.rotation,this.Gc,this.zc),this.I&&r.fill(),this.N&&r.stroke(),r.closePath())};z.prototype.P=function(r,
n){this.l.x=r;this.l.y=n};return z}(f.Ha);x.hc=y;y=function(u){function z(r,n,e,a,b,h){void 0===e&&(e=0);void 0===a&&(a=2*Math.PI);var t=u.call(this)||this;t.wa=[5,5];t.ya=[];t.xa=!1;t.Z="38";t.l=r;t.U=n;t.Gc=e;t.zc=a;b&&(t.strokeStyle=b);h&&(t.lineWidth=h);return t}Y(z,u);z.prototype.show=function(r,n){r&&(this.I||this.N)&&(r.beginPath(),r.lineCap="round",this.xa?r.setLineDash(this.wa):r.setLineDash(this.ya),r.arc(n.x+this.l.x,n.y+this.l.y,this.U,this.Gc,this.zc),this.I&&r.fill(),this.N&&r.stroke(),
r.closePath())};z.prototype.scale=function(r,n){void 0===n&&(n=!0);n?(r=this.U*r,this.l.x=this.l.x+r-this.U,this.l.y=this.l.y+r-this.U,this.U=r):(this.l.x=this.l.x+r-this.U,this.l.y=this.l.y+r-this.U,this.U=r)};z.prototype.P=function(r,n){this.l.x=r;this.l.y=n};return z}(f.Ha);x.Lc=y;y=function(u){function z(r,n,e,a,b,h,t){void 0===e&&(e=0);void 0===a&&(a=2*Math.PI);void 0===b&&(b=0);r=u.call(this,r,n,e,a,h,t)||this;r.Z="39";r.R=b;r.kb=2*n;return r}Y(z,u);return z}(y);x.V=y;f=function(u){function z(r,
n,e,a){var b=u.call(this)||this;b.fb=[];b.Ea=[];b.xb=!1;b.fontSize=20;b.fontFamily="Microsoft YaHei";b.Ec=0;b.Dc=.3;b.sc=!0;b.Jd=!0;b.be=0;b.Ma=0;b.Qb=0;b.Z="391";b.parent=r;b.l=n;b.text=e;b.w=a;b.I=!0;b.N=!1;b.pd();return b}Y(z,u);z.prototype.Eb=function(r){this.xb=!1;this.text=r};z.prototype.cd=function(r){if(!this.xb){this.xb=!0;this.Qb=this.Ma=0;var n=this.fb;n.length=0;this.Ea.length=0;if(0<this.text.length){for(var e=0;e<this.text.length;e++){var a=this.text[e];if(a){var b=r.measureText(a).width;
if(this.sc){var h=a.length;this.be=b;var t=Math.floor(this.w/(b/h));b=0;for(var w,A,B;b<h;){w=b+Math.min(h-b,t);A=a.substring(b,w);B=r.measureText(A).width;if(B>this.w)for(;b<w&&B>this.w;)w--,A=a.substring(b,w),B=r.measureText(A).width;else if(B<this.w)for(var D,H;w<h;)if(w++,H=a.substring(b,w),D=r.measureText(A).width,D<this.w)A=H,B=D;else if(D==this.w){A=H;B=D;break}else if(D>this.w){w--;break}n.push(A);B>this.Ma&&(this.Ma=B);B>=this.w?this.Ea.push(0):this.Ea.push((this.w-B)/2);b=w}}else n.push(a),
b>this.Ma&&(this.Ma=b),this.Ea.push(b)}else n.push(""),this.Ea.push(0)}this.Qb=(n.length-1)*(this.fontSize*(1+this.Dc)+this.Ec)+this.fontSize;if(!this.sc)for(b=0,r=this.Ea.length;b<r;b++)this.Ea[b]=this.Ea[b]>=this.Ma?0:(this.Ma-this.Ea[b])/2}this.pd()}};z.prototype.pd=function(){if(this.parent){var r=this.fontSize*(1+this.Dc)+this.Ec,n=this.fontSize;1<this.fb.length&&(n=this.fontSize+(this.fb.length-1)*r);n<this.parent.j?(this.l.y=(this.parent.j-n)/2-5,0>this.l.y&&(this.l.y=0)):this.l.y=0}};z.prototype.show=
function(r,n){if(r&&(this.I||this.N)&&(r.font=this.fontSize+"px "+this.fontFamily,this.xb||this.cd(r),this.text)){r.beginPath();var e=this.fontSize*(1+this.Dc)+this.Ec;if(this.I)for(var a=this.fontSize,b=0;b<this.fb.length;b++)r.fillText(this.fb[b],n.x+this.l.x+this.Ea[b],n.y+this.l.y+a),a+=e;if(this.N)for(a=this.fontSize,b=0;b<this.fb.length;b++)r.strokeText(this.fb[b],n.x+this.l.x+this.Ea[b],n.y+this.l.y+a),a+=e;r.closePath()}};z.prototype.scale=function(r){this.w=r;this.xb=!1};z.prototype.P=function(r,
n){this.l.x=r;this.l.y=n};return z}(f.Ha);x.Hb=f});
define("process/ProcProc","require exports core/base/BaseBean core/base/BaseShape core/base/Node util/CommonUtil".split(" "),function(y,x,f,u,z,r){Object.defineProperty(x,"__esModule",{value:!0});x.fc=x.ic=x.dc=x.ec=x.bc=x.jc=void 0;y=function(n){function e(a,b,h,t,w,A){void 0===w&&(w=[]);void 0===A&&(A=!1);a=n.call(this,a,b,h,t,w)||this;a.ub="\u8fc7\u7a0b";a.sb=null;a.cb=!1;a.Z="11";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/
2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.D=!1;a.ca.D=!1;a.aa.D=!1;a.ba.D=!1;a.qb([a.da,a.ca,a.aa,a.ba]);a.Da(A);return a}Y(e,n);e.prototype.clone=function(){return new e(r.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.o?this.o.text:[])};e.prototype.Da=function(a){var b=new u.Rect(new f.h(0,0),this.w,this.j);this.hb(b);this.sb=b;a?(b.I=!0,b.N=!1,b.fillStyle="#0099FF"):(b.I=!1,b.N=!0,b.strokeStyle="#000000",b.lineWidth=2)};e.prototype.scale=function(a,b){var h;
n.prototype.scale.call(this,a,b);null===(h=this.sb)||void 0===h?void 0:h.scale(a,b,!1)};e.prototype.Za=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(z.Ya);x.jc=y;y=function(n){function e(a,b,h,t,w,A){void 0===w&&(w=[]);void 0===A&&(A=!1);a=n.call(this,a,b,h,t,w)||this;
a.ub="\u5f00\u59cb/\u7ed3\u675f";a.sb=null;a.cb=!1;a.Z="12";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.D=!1;a.ca.D=!1;a.aa.D=!1;a.ba.D=!1;a.qb([a.da,a.ca,a.aa,a.ba]);a.Da(A);return a}Y(e,n);e.prototype.clone=function(){return new e(r.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.o?this.o.text:[])};e.prototype.Da=function(a){var b=
new u.cc(new f.h(0,0),this.w,this.j);this.hb(b);this.sb=b;a?(b.I=!0,b.N=!1,b.fillStyle="#0099FF"):(b.I=!1,b.N=!0,b.strokeStyle="#000000",b.lineWidth=2)};e.prototype.scale=function(a,b){var h;n.prototype.scale.call(this,a,b);null===(h=this.sb)||void 0===h?void 0:h.scale(a,b,!1)};e.prototype.Za=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);
this.fa.ondblclick=this.ondblclick};return e}(z.Ya);x.bc=y;y=function(n){function e(a,b,h,t,w,A){void 0===w&&(w=[]);void 0===A&&(A=!1);a=n.call(this,a,b,h,t,w)||this;a.ub="\u51b3\u7b56";a.B=null;a.cb=!1;a.Z="13";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.D=!1;a.ca.D=!1;a.aa.D=!1;a.ba.D=!1;a.qb([a.da,a.ca,a.aa,a.ba]);a.Da(A);return a}
Y(e,n);e.prototype.clone=function(){return new e(r.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.o?this.o.text:[])};e.prototype.Da=function(a){var b=new f.la(this.w/2,0);this.B=new u.rb([b,new f.la(this.w,this.j/2),new f.la(this.w/2,this.j),new f.la(0,this.j/2),b]);this.hb(this.B);a?(this.B.I=!0,this.B.N=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.N=!0,this.B.strokeStyle="#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);this.B&&(this.B.H[0].x=
this.w/2,this.B.H[1].x=this.w,this.B.H[1].y=this.j/2,this.B.H[2].x=this.w/2,this.B.H[2].y=this.j,this.B.H[3].y=this.j/2)};e.prototype.Za=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(z.Ya);x.ec=y;y=function(n){function e(a,b,h,t,w,A){void 0===w&&(w=[]);void 0===A&&(A=
!1);a=n.call(this,a,b,h,t,w)||this;a.ub="\u9875\u9762\u5185\u5f15\u7528";a.B=null;a.cb=!1;a.Z="14";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.D=!1;a.ca.D=!1;a.aa.D=!1;a.ba.D=!1;a.qb([a.da,a.ca,a.aa,a.ba]);a.Da(A);return a}Y(e,n);e.prototype.clone=function(){return new e(r.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.o?this.o.text:
[])};e.prototype.Da=function(a){var b=new f.h(this.w/2,this.j/2);this.B=new u.hc(b,b);this.hb(this.B);a?(this.B.I=!0,this.B.N=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.N=!0,this.B.strokeStyle="#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);this.B&&(this.B.l.x=this.w/2,this.B.l.y=this.j/2)};e.prototype.Za=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,
a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(z.Ya);x.dc=y;y=function(n){function e(a,b,h,t,w,A){void 0===w&&(w=[]);void 0===A&&(A=!1);a=n.call(this,a,b,h,t,w)||this;a.ub="\u6570\u636e";a.B=null;a.cb=!1;a.Z="15";b=2*Math.PI;h=a.j/a.w;h=h/(1+h)*a.w/4;a.o&&(a.o.l.x=2*h,a.o.w=a.w-4*h);a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w-h,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(h,
a.j/2),a.X,0,b,3,a.Y,1);a.da.D=!1;a.ca.D=!1;a.aa.D=!1;a.ba.D=!1;a.qb([a.da,a.ca,a.aa,a.ba]);a.Da(A);return a}Y(e,n);e.prototype.clone=function(){return new e(r.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.o?this.o.text:[])};e.prototype.Da=function(a){var b=this.j/this.w;b=b/(1+b)*this.w/2;var h=new f.la(b,0);this.B=new u.rb([h,new f.la(this.w,0),new f.la(this.w-b,this.j),new f.la(0,this.j),h]);this.hb(this.B);a?(this.B.I=!0,this.B.N=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.N=!0,this.B.strokeStyle=
"#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);a=this.j/this.w;a=a/(1+a)*this.w/2;this.B&&(this.B.H[0].x=a,this.B.H[1].x=this.w,this.B.H[2].x=this.w-a,this.B.H[2].y=this.j,this.B.H[3].y=this.j);this.o&&(this.o.l.x=a,this.o.w=this.w-2*a)};e.prototype.pc=function(){n.prototype.pc.call(this);var a=this.j/this.w;a=a/(1+a)*this.w/2;if(0<this.ha.length)for(var b=0;b<this.ha.length;b++){var h=this.ha[b];!h.fromPoint||1!=h.fromPoint.R&&3!=h.fromPoint.R||(1==
h.fromPoint.R?h.fromPoint.x=this.w-h.fromPoint.y/this.j*a:3==h.fromPoint.R&&(h.fromPoint.x=(this.j-h.fromPoint.y)/this.j*a),h.from.x=this.p.x+h.fromPoint.x,h.ma())}if(0<this.ga.length)for(b=0;b<this.ga.length;b++)h=this.ga[b],!h.F||1!=h.F.R&&3!=h.F.R||(1==h.F.R?h.F.x=this.w-h.F.y/this.j*a:3==h.F.R&&(h.F.x=(this.j-h.F.y)/this.j*a),h.g.x=this.p.x+h.F.x,h.ma())};e.prototype.Za=function(){var a=this.j/this.w;a=a/(1+a)*this.w/4;this.da.P(this.w/2,0);this.ca.P(this.w-a,this.j/2);this.aa.P(this.w/2,this.j);
this.ba.P(a,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a);if(a.S){var b=this.j/this.w;b=b/(1+b)*this.w/2;a.S.style.left=this.p.x+b+"px";a.S.style.width=this.w-2*b+"px"}};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(z.Ya);x.ic=y;z=function(n){function e(a,b,h,t,w,A){void 0===w&&(w=[]);void 0===A&&(A=!1);a=n.call(this,a,b,h,t,w)||this;a.ub="\u6587\u6863";a.B=null;a.cb=!1;a.Z="16";b=2*Math.PI;a.da=new u.V(new f.h(a.w/
2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.D=!1;a.ca.D=!1;a.aa.D=!1;a.ba.D=!1;a.qb([a.da,a.ca,a.aa,a.ba]);a.Da(A);return a}Y(e,n);e.prototype.clone=function(){return new e(r.L.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.o?this.o.text:[])};e.prototype.Da=function(a){var b=new f.la(0,this.j,1),h=new f.la(this.w,this.j,1);this.B=new u.rb([b,new f.la(0,0),new f.la(this.w,
0),h,new f.la(this.w/4*3,this.j/4*3,1),new f.la(this.w/4,this.j/4*5,1),b]);this.hb(this.B);a?(this.B.I=!0,this.B.N=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.N=!0,this.B.strokeStyle="#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);this.B&&(this.B.H[0].y=this.j,this.B.H[2].x=this.w,this.B.H[3].x=this.w,this.B.H[3].y=this.j,this.B.H[4].x=this.w/4*3,this.B.H[4].y=this.j/4*3,this.B.H[5].x=this.w/4,this.B.H[5].y=this.j/4*5)};e.prototype.Za=function(){this.da.P(this.w/
2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(z.Ya);x.fc=z});
define("layer/ModelLayer",["require","exports","core/base/BaseBean","AntLiuApp"],function(y,x,f,u){Object.defineProperty(x,"__esModule",{value:!0});x.Nc=void 0;y=function(){function z(r){this.J=[];this.anchorNode=this.ka=null;this.O=!1;this.Oa=new f.h(1,1);this.cb=!1;this.A=this.T=null;this.Ca=this.va=0;this.G=new f.h(0,0);this.Cc=this.Yd=this.ee=5;this.Md=10;this.hd=20;if(this.id=r)if(r=document.getElementById(r))if(this.va=r.clientWidth,this.Ca=500,this.A=document.createElement("canvas"),this.A.width=
this.va,this.A.height=this.Ca,r.appendChild(this.A),this.T=this.A.getContext("2d"))this.T.imageSmoothingEnabled=!0,r=window.devicePixelRatio,this.A.style.width=this.va+"px",this.A.style.height=this.Ca+"px",this.A.width=this.va*r,this.A.height=this.Ca*r,this.T.scale(r,r),this.Bc()}z.prototype.Vd=function(){if(this.A)for(var r=this.Cc,n=this.ee,e=!0,a=0;a<this.J.length;a++){var b=this.J[a];e?e=!1:r+b.w+this.Yd>this.va&&(r=this.Cc,n=n+b.j+this.hd);b.p.x=r;b.p.y=n;r=r+b.w+this.Md;r>this.va&&(e=!0,r=this.Cc,
n=n+b.j+this.hd)}};z.prototype.Fa=function(r){this.J.push(r)};z.prototype.qa=function(){if(this.A&&this.T&&(this.T.clearRect(0,0,this.A.width,this.A.height),0<this.J.length))for(var r=0;r<this.J.length;r++)this.J[r].show(this.T);this.O=!1};z.prototype.wc=function(r){this.G.x=1==this.Oa.x?r.offsetX:r.offsetX/this.Oa.x;this.G.y=1==this.Oa.y?r.offsetY:r.offsetY/this.Oa.y;"mousemove"==r.type?this.Kc(r):"mousedown"==r.type?this.Jc(r):"mouseup"==r.type&&this.fe()};z.prototype.Vb=function(){this.anchorNode&&
(this.anchorNode=null,u.ra&&(u.ra.wb=!1))};z.prototype.fe=function(){this.anchorNode&&(this.anchorNode=null,u.ra&&(u.ra.wb=!1))};z.prototype.Jc=function(r){if(1==r.buttons&&this.J){r=!1;for(var n=this.G.x,e=this.G.y,a=this.J.length-1;-1<a;a--){var b=this.J[a];if(n>b.p.x&&e>b.p.y&&n<b.p.x+b.w&&e<b.p.y+b.j){r=!0;this.anchorNode=b;u.ra&&(u.ra.wb=!0,u.ra.bd=this.anchorNode.Z);break}}!r&&this.anchorNode&&(this.anchorNode=null)}};z.prototype.Kc=function(r){if(1!=r.buttons||!this.anchorNode)if(this.anchorNode&&
(this.anchorNode=null),r=!1,this.J){for(var n=this.G.x,e=this.G.y,a=this.J.length-1;-1<a;a--){var b=this.J[a];if(n>b.p.x&&e>b.p.y&&n<b.p.x+b.w&&e<b.p.y+b.j){r=!0;this.ka?this.ka!=b&&(this.ka=b):this.ka=b;break}}!r&&this.ka&&(this.ka=null)}};z.prototype.Bc=function(){if(this.A){var r=this,n=function(e){r.wc(e);e.stopPropagation()};this.A.onmousedown=n;this.A.onmouseup=n;this.A.onmousemove=n;document.addEventListener("mouseup",function(){r.Vb()})}};return z}();x.Nc=y});
define("AntLiuApp","require exports process/ProcProc core/base/BaseBean layer/ModelLayer layer/DrawLayer util/CommonUtil".split(" "),function(y,x,f,u,z,r,n){function e(){var b=document.getElementById(a.lineBtBsizer);b&&(b.onclick=function(){x.ra&&x.ra.Vc(2)});if(b=document.getElementById(a.lineBtPloy))b.onclick=function(){x.ra&&x.ra.Vc(0)};if(b=document.getElementById(a.canvasImgDownBt))b.onclick=function(){x.ra&&x.ra.Zd()}}Object.defineProperty(x,"__esModule",{value:!0});x.ud=x.Ia=x.ra=void 0;var a=
{};x.ud=function(b,h){if(b=document.getElementById(b)){h&&(a=h);var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;b.style.height=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)-100+"px";b.style.width=t+"px";h=document.createElement("div");h.id=n.L.W();h.style.width=t-150-5+"px";h.className="canvasBox";t=document.createElement("div");t.id=n.L.W();t.className="modelBox";b.appendChild(t);b.appendChild(h);x.ra=new r.Mc(h.id);
if(b=document.getElementById(t.id))h=n.L.W(),t=document.createElement("div"),t.id=h,t.style.width="100%",b.appendChild(t),x.Ia=new z.Nc(h),x.Ia.Fa(new f.jc(n.L.W(),new u.h(5,5),40,20)),x.Ia.Fa(new f.bc(n.L.W(),new u.h(5,5),40,20)),x.Ia.Fa(new f.ec(n.L.W(),new u.h(5,5),40,20)),x.Ia.Fa(new f.dc(n.L.W(),new u.h(5,5),20,20)),x.Ia.Fa(new f.ic(n.L.W(),new u.h(5,5),40,20)),x.Ia.Fa(new f.fc(n.L.W(),new u.h(5,5),40,20)),x.Ia.Vd(),x.Ia.qa();e()}}});
