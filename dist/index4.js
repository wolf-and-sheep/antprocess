var C="function"==typeof Object.defineProperties?Object.defineProperty:function(y,x,f){if(y==Array.prototype||y==Object.prototype)return y;y[x]=f.value;return y};function F(y){y=["object"==typeof globalThis&&globalThis,y,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var x=0;x<y.length;++x){var f=y[x];if(f&&f.Math==Math)return f}throw Error("Cannot find global object");}var G=F(this);
function I(y,x){if(x)a:{var f=G;y=y.split(".");for(var u=0;u<y.length-1;u++){var A=y[u];if(!(A in f))break a;f=f[A]}y=y[y.length-1];u=f[y];x=x(u);x!=u&&null!=x&&C(f,y,{configurable:!0,writable:!0,value:x})}}var J;if("function"==typeof Object.setPrototypeOf)J=Object.setPrototypeOf;else{var K;a:{var L={a:!0},N={};try{N.__proto__=L;K=N.a;break a}catch(y){}K=!1}J=K?function(y,x){y.__proto__=x;if(y.__proto__!==x)throw new TypeError(y+" is not extensible");return y}:null}var Q=J;
I("Object.setPrototypeOf",function(y){return y||Q});function U(y){var x=0;return function(){return x<y.length?{done:!1,value:y[x++]}:{done:!0}}}I("Symbol",function(y){function x(r){if(this instanceof x)throw new TypeError("Symbol is not a constructor");return new f(u+(r||"")+"_"+A++,r)}function f(r,n){this.Wb=r;C(this,"description",{configurable:!0,writable:!0,value:n})}if(y)return y;f.prototype.toString=function(){return this.Wb};var u="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",A=0;return x});
I("Symbol.iterator",function(y){if(y)return y;y=Symbol("Symbol.iterator");for(var x="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<x.length;f++){var u=G[x[f]];"function"===typeof u&&"function"!=typeof u.prototype[y]&&C(u.prototype,y,{configurable:!0,writable:!0,value:function(){return V(U(this))}})}return y});function V(y){y={next:y};y[Symbol.iterator]=function(){return this};return y}
function W(y,x){y instanceof String&&(y+="");var f=0,u=!1,A={next:function(){if(!u&&f<y.length){var r=f++;return{value:x(r,y[r]),done:!1}}u=!0;return{done:!0,value:void 0}}};A[Symbol.iterator]=function(){return A};return A}I("Array.prototype.keys",function(y){return y?y:function(){return W(this,function(x){return x})}});
I("Array.prototype.fill",function(y){return y?y:function(x,f,u){var A=this.length||0;0>f&&(f=Math.max(0,A+f));if(null==u||u>A)u=A;u=Number(u);0>u&&(u=Math.max(0,A+u));for(f=Number(f||0);f<u;f++)this[f]=x;return this}});function X(y){return y?y:Array.prototype.fill}I("Int8Array.prototype.fill",X);I("Uint8Array.prototype.fill",X);I("Uint8ClampedArray.prototype.fill",X);I("Int16Array.prototype.fill",X);I("Uint16Array.prototype.fill",X);I("Int32Array.prototype.fill",X);
I("Uint32Array.prototype.fill",X);I("Float32Array.prototype.fill",X);I("Float64Array.prototype.fill",X);
var Y=this&&this.Wb||function(){function y(x,f){y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,A){u.__proto__=A}||function(u,A){for(var r in A)Object.prototype.hasOwnProperty.call(A,r)&&(u[r]=A[r])};return y(x,f)}return function(x,f){function u(){this.constructor=x}if("function"!==typeof f&&null!==f)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");y(x,f);x.prototype=null===f?Object.create(f):(u.prototype=f.prototype,new u)}}();
define("core/base/BaseBean",["require","exports"],function(y,x){Object.defineProperty(x,"__esModule",{value:!0});x.$=x.ea=x.bb=x.la=x.h=void 0;y=function(){return function(u,A){this.Z="41";this.y=this.x=0;this.x=u;this.y=A}}();x.h=y;var f=function(u){function A(r,n,e){void 0===e&&(e=0);r=u.call(this,r,n)||this;r.type=0;r.type=e;r.Z="42";return r}Y(A,u);return A}(y);x.la=f;y=function(u){function A(r,n,e){void 0===e&&(e=0);r=u.call(this,r,n)||this;r.R=0;r.R=e;r.Z="43";return r}Y(A,u);return A}(y);x.bb=
y;x.ea=function(){function u(){}u.click="click";u.Fd="dblclick";u.Qd="mousedown";u.nd="mouseup";u.md="mousemove";u.ld="mouseenterleave";u.Nd="dragmousemove";u.anchor="anchor";u.scale="scale";u.onclick="onclick";u.ondblclick="ondblclick";u.onmousedown="onmousedown";u.onmouseup="onmouseup";u.onmouseenter="onmouseenter";u.onmouseleave="onmouseleave";u.onmousemove="onmousemove";u.$a="ondragmousemove";u.bc="onanchor";u.cc="onunanchor";return u}();x.$=function(){function u(){}u.default="default";u.move=
"move";u.ed="crosshair";u.hc="se-resize";u.ac="ne-resize";u.sd="pointer";u.ud="s-resize";u.wd="w-resize";return u}()});
define("core/base/Pen",["require","exports"],function(y,x){Object.defineProperty(x,"__esModule",{value:!0});x.Oa=void 0;y=function(){function f(){this.Z="31";this.strokeStyle=this.fillStyle="#000000";this.I=!1;this.C=this.O=!0;this.lineWidth=1}f.prototype.sa=function(u,A){this.I&&this.fillStyle&&(u.fillStyle=this.fillStyle);this.O&&this.strokeStyle&&(u.strokeStyle=this.strokeStyle,u.lineWidth=this.lineWidth);this.show(u,A)};return f}();x.Oa=y});
define("layer/BeanFactory","require exports core/base/BaseBean core/base/BaseShape process/ProcProc core/base/LinkLine util/CommonUtil".split(" "),function(y,x,f,u,A,r,n){Object.defineProperty(x,"__esModule",{value:!0});x.Nb=void 0;x.Nb=function(){function e(){}e.createNode=function(a){var b=n.K.W(),h=null;switch(a){case "11":h=new A.sc(b,new f.h(0,0),100,60,[],!1);break;case "12":h=new A.kc(b,new f.h(0,0),100,60,[],!1);break;case "13":h=new A.oc(b,new f.h(0,0),100,60,[],!1);break;case "14":h=new A.nc(b,
new f.h(0,0),60,60,[],!1);break;case "15":h=new A.rc(b,new f.h(0,0),100,60,[],!1);break;case "16":h=new A.pc(b,new f.h(0,0),100,60,[],!1)}return h};e.Dd=function(a){var b=null;switch(a){case "32":b=new u.jc(new f.h(0,0),10,14,3);break;case "33":b=new u.Wc(new f.h(0,0),new f.h(1,1),new f.h(2,2));break;case "34":b=new u.vb([]);break;case "35":b=new u.Rect(new f.h(0,0),60,60);break;case "36":b=new u.lc(new f.h(0,0),100,60);break;case "37":b=new u.qc(new f.h(0,0),new f.h(0,0));break;case "8":b=new u.mc(new f.h(0,
0),2);break;case "39":b=new u.V(new f.h(0,0),2);break;case "391":b=new u.Qb(null,new f.h(0,0),[],20)}return b};e.Ed=function(a){var b=null;switch(a){case "41":b=new f.h(0,0);break;case "42":b=new f.la(0,0);break;case "43":b=new f.bb(0,0)}return b};e.Cd=function(a){var b=null;switch(a){case "21":b=new r.Ha(n.K.W(),new f.h(0,0),new f.h(200,200),0);break;case "22":b=new r.uc(n.K.W(),new f.h(0,0),new f.h(200,200),0)}return b};e.bd=function(a){if(!a)return null;var b=null;switch(a.substr(0,1)){case "1":b=
e.createNode(a);break;case "2":b=e.Cd(a);break;case "3":b=e.Dd(a);break;case "4":b=e.Ed(a)}return b};return e}()});
define("util/CommonUtil",["require","exports","core/base/LinkLine","core/base/Node","layer/BeanFactory"],function(y,x,f,u,A){Object.defineProperty(x,"__esModule",{value:!0});x.K=void 0;x.K=function(){function r(){}r.W=function(){return Date.now()+"_"+Math.ceil(100*Math.random())+"_"+Math.ceil(100*Math.random())+"_"+Math.ceil(100*Math.random())};r.Kb=function(n){if(!n)return n;if(n instanceof Array){var e=[];if(1>n.length)return e;if(n[0]instanceof u.Node||n[0]instanceof f.Ha)return null;for(var a=
0;a<n.length;a++){var b=n[a];if(b)switch(typeof b){case "bigint":case "number":case "string":case "boolean":e[a]=b;break;case "object":b instanceof u.Node||b instanceof f.Ha||(e[a]=r.Kb(b))}else e[a]=b}return e}e=0;var h={},t=Object.keys(n);for(a=0;a<t.length;a++){b=t[a];var w=Object.getOwnPropertyDescriptor(n,b);if(w)if(w.value)switch(typeof w.value){case "bigint":case "number":case "string":case "boolean":h[b]=w.value;e++;break;case "object":w.value instanceof u.Node||w.value instanceof f.Ha||(w=
r.Kb(w.value))&&(h[b]=w)}else h[b]=w.value}return 0>=e?null:h};r.Jb=function(n){if(!n)return n;if(n instanceof Array){var e=[];if(1>n.length)return e;if(n[0]instanceof f.Ha)return null;for(var a=0;a<n.length;a++){var b=n[a];if(b)switch(typeof b){case "bigint":case "number":case "string":case "boolean":e[a]=b;break;case "object":b instanceof f.Ha||(e[a]=b instanceof u.Node?{objtype:b.Z,id:b.id}:r.Jb(b))}else e[a]=b}return e}e={};var h=0,t=Object.keys(n);for(a=0;a<t.length;a++)if(b=t[a],"linePath"!=
b){var w=Object.getOwnPropertyDescriptor(n,b);if(w)if(w.value)switch(typeof w.value){case "bigint":case "number":case "string":case "boolean":e[b]=w.value;h++;break;case "object":w.value instanceof f.Ha||(w.value instanceof u.Node?e[b]={objtype:w.value.Z,id:w.value.id}:(w=r.Jb(w.value))&&(e[b]=w))}else e[b]=w.value}return 0>=h?null:e};r.cd=function(n){if(!n)return null;var e=Object.getOwnPropertyDescriptor(n,"objtype");return e&&e.value&&"string"==typeof e.value?((e=A.Nb.bd(e.value))&&r.yc(e,n),e):
null};r.yc=function(n,e){if(n&&e)for(var a=Object.keys(e),b=Object.keys(n),h=0;h<a.length;h++){var t=a[h],w=Object.getOwnPropertyDescriptor(e,t);if(w)if(w.value){var z=typeof w.value;if(0>b.indexOf(t))"object"==z?(z=r.cd(w.value))?Object.defineProperty(n,t,{value:z,configurable:!0,writable:!0}):Object.defineProperty(n,t,w):Object.defineProperty(n,t,w);else{var B=Object.getOwnPropertyDescriptor(n,t);if(!B||!B.value)"object"==z?(z=r.cd(w.value))?Object.defineProperty(n,t,{value:z,configurable:!0,writable:!0}):
Object.defineProperty(n,t,w):Object.defineProperty(n,t,w);else if(z==typeof B.value)switch(z){case "bigint":case "number":case "string":case "boolean":case "undefined":Object.defineProperty(n,t,w);break;case "object":r.yc(B.value,w.value)}}}else Object.defineProperty(n,t,w)}};r.dd=function(n,e){if(!e)return null;var a=Object.getOwnPropertyDescriptor(e,"objtype");if(a&&a.value&&"string"==typeof a.value)if("1"==a.value.charAt(0)){if((e=Object.getOwnPropertyDescriptor(e,"id"))&&e.value&&"string"==typeof e.value)for(a=
0;a<n.J.length;a++){var b=n.J[a];if(e.value==b.id)return b}}else return(a=A.Nb.bd(a.value))&&r.zc(n,a,e),a;return null};r.zc=function(n,e,a){if(e&&a)for(var b=Object.keys(a),h=Object.keys(e),t=0;t<b.length;t++){var w=b[t],z=Object.getOwnPropertyDescriptor(a,w);if(z)if(z.value){var B=typeof z.value;if(0>h.indexOf(w))"object"==B?(B=r.dd(n,z.value))?Object.defineProperty(e,w,{value:B,configurable:!0,writable:!0}):Object.defineProperty(e,w,z):Object.defineProperty(e,w,z);else{var D=Object.getOwnPropertyDescriptor(e,
w);if(!D||!D.value)"object"==B?(B=r.dd(n,z.value))?Object.defineProperty(e,w,{value:B,configurable:!0,writable:!0}):Object.defineProperty(e,w,z):Object.defineProperty(e,w,z);else if(B==typeof D.value)switch(B){case "bigint":case "number":case "string":case "boolean":case "undefined":Object.defineProperty(e,w,z);break;case "object":r.zc(n,D.value,z.value)}}}else Object.defineProperty(e,w,z)}};return r}()});
define("layer/DrawLayer","require exports core/base/BaseBean core/base/LinkLine core/base/Node util/CommonUtil layer/Action layer/BeanFactory".split(" "),function(y,x,f,u,A,r,n,e){Object.defineProperty(x,"__esModule",{value:!0});x.Sc=void 0;y=function(){function a(b){this.Rd=[f.ea.click,f.ea.Fd,f.ea.Qd,f.ea.nd,f.ea.Nd,f.ea.ld];this.J=[];this.lines=[];this.gb={};this.xb=this.tb=this.ga=this.xa=this.Ub=this.anchorNode=this.ka=this.Ya=null;this.va=new u.Ha(r.K.W(),new f.h(0,0),new f.h(0,0),0);this.Ab=
!1;this.hd="11";this.L=!1;this.Ua=new f.h(1,1);this.hb=!1;this.A=this.U=null;this.G=new f.h(0,0);this.Cb=0;this.Db="";this.N=this.T=null;this.Za=new f.h(0,0);this.qb=new f.h(0,0);this.Ra=this.fb=null;this.Xb=10;this.Yb=1;this.maxHeight=this.maxWidth=15E3;this.Ja=this.Aa=0;this.Bd="#FFFFFF";this.Sb=!1;this.mb=null;this.pd={};this.Hb=[];this.Xa=this.zb=this.Gc=this.Fc=!1;if(this.id=b)if(b=document.getElementById(b)){var h=document.documentElement.clientWidth,t=document.documentElement.clientHeight;
this.A=document.createElement("canvas");this.A.width=h;this.A.height=t;b.appendChild(this.A);if(this.U=this.A.getContext("2d")){this.U.imageSmoothingEnabled=!0;var w=window.devicePixelRatio;this.Aa=h;this.Ja=t;this.A.style.width=h+"px";this.A.style.height=t+"px";this.A.width=h*w;this.A.height=t*w;this.U.scale(w,w);this.T=document.createElement("div");this.T.className="textEditArea";this.T.style.visibility="hidden";this.T.contentEditable="true";this.T.style.Wb="#0000FF";h=function(B){B.stopPropagation()};
this.T.addEventListener("keydown",h);this.T.addEventListener("keypress",h);this.T.addEventListener("keyup",h);b.appendChild(this.T);this.N=document.createElement("div");this.N.className="lineTextEditArea";this.N.style.visibility="hidden";this.N.contentEditable="true";this.N.style.Wb="#0000FF";this.N.addEventListener("keydown",h);this.N.addEventListener("keypress",h);var z=this;this.N.addEventListener("keyup",function(B){z.Od();B.stopPropagation()});b.appendChild(this.N);this.mb=document.createElement("a");
this.mb.style.display="none";this.Ic()}}}a.prototype.ta=function(b){200<this.Hb.length&&this.J.splice(0,1);this.Hb.push(b)};a.prototype.Md=function(){var b=this.Hb.length-1;if(0<=b){var h=this.Hb[b];this.Hb.splice(b,1);h.back(this);this.L=!0}};a.prototype.Od=function(){if(this.N){var b=this.N.offsetWidth-this.qb.x;0!=b&&(this.qb.x=this.N.offsetWidth,this.Za.x-=b/2,this.N.style.left=this.Za.x+"px");b=this.N.offsetHeight-this.qb.y;0!=b&&(this.qb.y=this.N.offsetHeight,this.Za.y-=b/2,this.N.style.top=
this.Za.y+"px")}};a.prototype.saveData=function(){for(var b=[],h=0;h<this.J.length;h++){var t=r.K.Kb(this.J[h]);b.push(t)}this.pd.nodes=r.K.Kb(b);b=[];for(h=0;h<this.lines.length;h++)t=r.K.Jb(this.lines[h]),b.push(t);this.pd.lines=r.K.Jb(b)};a.prototype.ee=function(){if(this.A&&this.U&&this.mb){var b=this.Sb;b||(this.Sb=!0,this.sa());var h=this.A.toDataURL("image/png");this.Sb=b;this.mb.download=Date.now()+".png";this.mb.href=h;this.mb.click()}};a.prototype.ad=function(b){if(0==b||2==b)this.va.type=
b,this.ga&&this.ga.type!=b&&(this.ga.type=b,this.ga.ma(),this.sa())};a.prototype.ie=function(b,h){h||(h=this.lines.indexOf(b));0<=h&&h!=this.lines.length-1&&(this.lines.splice(h,1),this.lines.push(b))};a.prototype.je=function(b,h){h||(h=this.J.indexOf(b));0<=h&&h!=this.J.length-1&&(this.J.splice(h,1),this.J.push(b))};a.prototype.Pc=function(b,h,t){t||(t=h.indexOf(b));0<=t&&t!=h.length-1&&(h.splice(t,1),h.push(b))};a.prototype.Ma=function(b){0>this.J.indexOf(b)&&(this.J.push(b),this.yd(b))};a.prototype.Dc=
function(b){var h=this.J.indexOf(b);0<=h&&this.J.splice(h,1);if(b instanceof A.wa){for(var t=0;t<b.ha.length;t++)h=b.ha[t],h.o=null,h.F=null;for(t=0;t<b.ia.length;t++)h=b.ia[t],h.v=null,h.fromPoint=null}this.anchorNode==b&&(this.anchorNode=null);for(t in this.gb)if(h=this.gb[t]){var w=h.indexOf(b);0<=w&&h.splice(w,1)}};a.prototype.wc=function(b){0>this.lines.indexOf(b)&&this.lines.push(b)};a.prototype.Gd=function(b){var h=this.lines.indexOf(b);0<=h&&(this.ta(new n.Uc(b)),this.lines.splice(h,1));b.v&&
b.v.Bc(b,!1);b.o&&b.o.Cc(b,!1);this.ga==b&&(this.ga=null)};a.prototype.sa=function(){if(this.A&&this.U){this.Sb?(this.U.fillStyle=this.Bd,this.U.fillRect(0,0,this.A.width,this.A.height)):this.U.clearRect(0,0,this.A.width,this.A.height);if(0<this.J.length)for(var b=0;b<this.J.length;b++){var h=this.J[b];h.show(this.U)}if(0<this.lines.length)for(b=0;b<this.lines.length;b++)h=this.lines[b],h.show(this.U)}this.L=!1};a.prototype.yd=function(b){for(var h="mouseup mousedown dragmousemove mouseenterleave unanchor anchor click dblclick".split(" "),
t=0;t<h.length;t++){var w=h[t];if(!(0>this.Rd.indexOf(w))){var z=this.gb[w];z||(z=[],this.gb[w]=z);z.push(b)}}};a.prototype.Kd=function(b){var h=this.G.x,t=this.G.y;if(this.xa)return this.xa.pa(this),this.L&&this.sa(),!0;for(var w=this.lines.length-1;-1<w;w--){var z=this.lines[w];if(z.pa(this))return this.ie(z,w),this.L&&this.sa(),!0}return 1==b.buttons&&b.type==f.ea.md&&this.va.v&&this.va.fromPoint?(b=new u.uc(r.K.W(),new f.h(0,0),new f.h(h,t),this.va.type),this.va.v.vc(b,this.va.fromPoint),this.wc(b),
b.ra=b.g,this.va.v=null,this.va.fromPoint=null,this.xa=b,this.zb=!0):!1};a.prototype.Ld=function(b){return 1==b.buttons&&"mousemove"==b.type&&this.Ab&&(this.Ab=!1,b=e.Nb.createNode(this.hd))?(this.Ma(b),b.pb.x=-b.w/2,b.pb.y=-b.j/2,this.Fc=!0,this.Ya=b,!0):!1};a.prototype.Zb=function(){this.ga&&this.ga.oa.C&&(this.ga.oa.C=!1,this.L=!0)};a.prototype.Ec=function(b){if("mousedown"==b.type)if(this.fb&&this.fb.u&&this.T){for(var h=this.T.childNodes,t=[],w=0;w<h.length;w++){var z=h[w];t.push(z.textContent?
z.textContent:"")}this.fb.u.C=!0;this.fb.u.Lb(t);this.fb=null;this.T.style.visibility="hidden";this.L=!0}else if(this.Ra&&this.Ra.u&&this.N){h=this.N.childNodes;t=[];for(w=0;w<h.length;w++)z=h[w],t.push(z.textContent?z.textContent:"");this.Ra.u.C=!0;this.Ra.u.Lb(t);this.U&&this.Ra.u.jd(this.U);this.Ra.Nc();this.Ra=null;this.N.style.visibility="hidden";this.L=!0}this.G.x=1==this.Ua.x?b.offsetX:b.offsetX/this.Ua.x;this.G.y=1==this.Ua.y?b.offsetY:b.offsetY/this.Ua.y;this.Cb=b.buttons;this.Db=b.type;
if(!this.Ld(b))if(1==b.buttons&&this.Ya&&"mousemove"==b.type)this.Gc||(this.Gc=!0,this.ta(new n.kb(this.Ya))),this.Ya.pa(this,f.ea.$a),this.L&&this.sa();else if(!this.Kd(b)||"mousemove"==b.type&&this.xa){if("mousemove"==b.type)this.Rc(b);else if("mousedown"==b.type)this.Zb(),this.Qc(b);else if(h=this.gb[b.type]){t=this.G.x;var B=this.G.y;"mouseup"==b.type&&(this.ec(),this.va.v=null,this.va.fromPoint=null);for(w=h.length-1;-1<w;w--)if(z=h[w],t>z.p.x&&B>z.p.y&&t<z.p.x+z.w&&B<z.p.y+z.j){z.pa(this,"on"+
b.type);this.Pc(z,h,w);break}}this.L&&this.sa()}};a.prototype.Qc=function(b){if(1==b.buttons&&(b=this.gb[b.type])){for(var h=!1,t=this.G.x,w=this.G.y,z=b.length-1;-1<z;z--){var B=b[z];if(t>B.p.x-10&&w>B.p.y-10&&t<B.p.x+B.w+10&&w<B.p.y+B.j+10&&(B instanceof A.wa&&B.dc(this)||t>B.p.x&&w>B.p.y&&t<B.p.x+B.w&&w<B.p.y+B.j)){h=!0;this.ga=null;this.anchorNode?this.anchorNode!=B&&(this.anchorNode.pa(this,f.ea.cc),this.anchorNode=B,this.anchorNode.pa(this,f.ea.bc)):(this.anchorNode=B,this.anchorNode.pa(this,
f.ea.bc));B.pa(this,f.ea.onmousedown);this.je(B,z);this.Pc(B,b,z);break}}!h&&this.anchorNode&&(this.anchorNode.pa(this,f.ea.cc),this.anchorNode=null)}};a.prototype.Rc=function(){var b=this.gb[f.ea.ld],h=!1;if(b){for(var t=this.G.x,w=this.G.y,z=b.length-1;-1<z;z--){var B=b[z];if(t>B.p.x-10&&w>B.p.y-10&&t<B.p.x+B.w+10&&w<B.p.y+B.j+10&&(B instanceof A.wa&&B.dc(this)||t>B.p.x&&w>B.p.y&&t<B.p.x+B.w&&w<B.p.y+B.j)){h=!0;this.ka?this.ka!=B?(this.ka.pa(this,f.ea.onmouseleave),this.ka=B,this.ka.pa(this,f.ea.onmouseenter)):
this.xa||(B.pa(this,f.ea.onmousemove),this.Pc(B,b,z)):(this.ka=B,this.ka.pa(this,f.ea.onmouseenter));break}}!h&&this.ka&&(this.ka.pa(this,f.ea.onmouseleave),this.ka=null)}h||!this.A||this.A.style.cursor==f.$.default||this.xa||(this.A.style.cursor=f.$.default)};a.prototype.Id=function(b){if(this.A)switch(b.key.toLowerCase()){case "backspace":case "delete":this.anchorNode?(this.ta(new n.Vc(this.anchorNode)),this.Dc(this.anchorNode),this.L=!0):this.ga&&(this.Gd(this.ga),this.L=!0)}};a.prototype.Hd=function(b){if(this.A&&
this.U)switch(b.key.toLowerCase()){case "c":b.ctrlKey&&(this.anchorNode?(this.Ub=this.anchorNode,this.xb=null):(this.ga?this.xb=this.ga:this.xb=null,this.Ub=null));break;case "v":if(b.ctrlKey)if(this.Ub){b=this.Ub.clone();b.p.x+=5;b.p.y+=5;this.Ma(b);var h=new A.Node("-1",new f.h(0,0),1,1);h.id=b.id;this.ta(new n.tc(h));this.L=!0}else this.xb&&(b=this.xb.clone(),b.from.x+=5,b.from.y+=5,b.g.x+=5,b.g.y+=5,b.ma(),this.wc(b),h=new u.Ha("-1",new f.h(0,0),new f.h(0,0),0),h.id=b.id,this.ta(new n.Ob(h)),
this.L=!0);break;case "z":b.ctrlKey&&this.Md();break;case "arrowdown":this.anchorNode&&this.anchorNode.p.y<this.maxHeight&&(this.ta(new n.kb(this.anchorNode)),this.anchorNode.p.y=b.shiftKey?this.anchorNode.p.y+this.Yb:this.anchorNode.p.y+this.Xb,this.anchorNode.p.y+this.anchorNode.j>this.Ja&&(b=window.devicePixelRatio,this.Ja+=100,this.A.style.height=this.Ja+"px",this.A.height=this.Ja*b,this.U.scale(b,b)),this.anchorNode instanceof A.wa&&this.anchorNode.nb(),this.L=!0);break;case "arrowup":this.anchorNode&&
0<this.anchorNode.p.y+this.anchorNode.j&&(this.ta(new n.kb(this.anchorNode)),this.anchorNode.p.y=b.shiftKey?this.anchorNode.p.y-this.Yb:this.anchorNode.p.y-this.Xb,this.anchorNode instanceof A.wa&&this.anchorNode.nb(),this.L=!0);break;case "arrowright":this.anchorNode&&this.anchorNode.p.x<this.maxWidth&&(this.ta(new n.kb(this.anchorNode)),this.anchorNode.p.x=b.shiftKey?this.anchorNode.p.x+this.Yb:this.anchorNode.p.x+this.Xb,this.anchorNode.p.x+this.anchorNode.w>this.Aa&&(b=window.devicePixelRatio,
this.Aa+=100,this.A.style.width=this.Aa+"px",this.A.width=this.Aa*b,this.U.scale(b,b)),this.anchorNode instanceof A.wa&&this.anchorNode.nb(),this.L=!0);break;case "arrowleft":this.anchorNode&&0<this.anchorNode.p.x+this.anchorNode.w&&(this.ta(new n.kb(this.anchorNode)),this.anchorNode.p.x=b.shiftKey?this.anchorNode.p.x-this.Yb:this.anchorNode.p.x-this.Xb,this.anchorNode instanceof A.wa&&this.anchorNode.nb(),this.L=!0)}};a.prototype.Jd=function(b){"keyup"==b.type?this.Id(b):"keydown"==b.type&&this.Hd(b);
this.L&&this.sa()};a.prototype.ec=function(){if(this.Ya){if(this.Fc){this.Fc=!1;var b=new A.Node("-1",new f.h(0,0),1,1);b.id=this.Ya.id;this.ta(new n.tc(b))}this.Gc=!1;this.Ya=null}this.xa&&(this.xa=null,this.zb&&(this.zb=!1,b=new u.Ha("-1",new f.h(0,0),new f.h(0,0),0),b.id=this.id,this.ta(new n.Ob(b))),this.Xa=!1)};a.prototype.Ic=function(){if(this.A){var b=this,h=function(t){b.Ec(t);t.stopPropagation()};this.A.onclick=h;this.A.ondblclick=h;this.A.onmousedown=h;this.A.onmouseup=h;this.A.onmousemove=
h;document.addEventListener("mouseup",function(){b.ec()});h=function(t){"f12"!=t.key.toLowerCase()&&(t.preventDefault(),b.Jd(t),t.stopPropagation())};this.A.parentElement&&(document.onkeydown=h,document.onkeyup=h)}};return a}();x.Sc=y});
define("layer/Action",["require","exports","core/base/BaseBean","core/base/Node","util/CommonUtil"],function(y,x,f,u,A){Object.defineProperty(x,"__esModule",{value:!0});x.Pb=x.Ob=x.Uc=x.kb=x.tc=x.Vc=x.xd=void 0;y=function(){function n(e){this.type=e}n.prototype.back=function(){};return n}();x.xd=y;var r=function(n){function e(a){var b=n.call(this,1)||this;b.Hc=[];b.Oc=[];b.n=a;if(b.n instanceof u.wa){a=0;for(var h=b.n.ia.length;a<h;a++){var t=b.n.ia[a];t.fromPoint&&b.Hc.push(new f.bb(t.fromPoint.x,
t.fromPoint.y,t.fromPoint.R))}a=0;for(h=b.n.ha.length;a<h;a++)t=b.n.ha[a],t.F&&b.Oc.push(new f.bb(t.F.x,t.F.y,t.F.R))}return b}Y(e,n);e.prototype.back=function(a){a.Ma(this.n);if(this.n instanceof u.wa){a=this.Hc.length;for(var b=0,h=this.n.ia.length;b<h;b++){var t=this.n.ia[b];a>b&&this.n.vc(t,this.Hc[b])}a=this.Oc.length;b=0;for(h=this.n.ha.length;b<h;b++)t=this.n.ha[b],a>b&&this.n.Zc(t,this.Oc[b])}};return e}(y);x.Vc=r;r=function(n){function e(a){var b=n.call(this,11)||this;b.n=a;return b}Y(e,
n);e.prototype.back=function(a){for(var b=0,h=a.J.length;b<h;b++)if(a.J[b].id==this.n.id){a.Dc(a.J[b]);break}};return e}(y);x.tc=r;r=function(n){function e(a){var b=n.call(this,12)||this;a=A.K.Kb(a);b.n=a;return b}Y(e,n);e.prototype.back=function(a){for(var b,h=0,t=a.J.length;h<t;h++)if(b=a.J[h],b.id==this.n.id){A.K.yc(b,this.n);b instanceof u.wa&&b.nb();break}};return e}(y);x.kb=r;r=function(n){function e(a){var b=n.call(this,2)||this;b.line=a;return b}Y(e,n);e.prototype.back=function(a){a.wc(this.line);
this.line.v&&this.line.fromPoint&&this.line.v.vc(this.line,this.line.fromPoint);this.line.o&&this.line.F&&this.line.o.Zc(this.line,this.line.F)};return e}(y);x.Uc=r;r=function(n){function e(a){var b=n.call(this,21)||this;b.line=a;return b}Y(e,n);e.prototype.back=function(a){for(var b=0,h=a.lines.length;b<h;b++)if(a.lines[b].id==this.line.id){a.Dc(a.J[b]);break}};return e}(y);x.Ob=r;y=function(n){function e(a){var b=n.call(this,22)||this;b.v=null;b.o=null;b.v=a.v;b.o=a.o;a=A.K.Jb(a);a.fromNode=null;
a.toNode=null;b.line=a;return b}Y(e,n);e.prototype.back=function(a){for(var b=0,h=a.lines.length;b<h;b++)if(a.lines[b].id==this.line.id){A.K.zc(a,a.lines[b],this.line);a.lines[b].v=this.v;a.lines[b].o=this.o;break}};return e}(y);x.Pb=y});
define("core/base/LinkLine","require exports core/base/BaseBean core/base/BaseShape core/base/Node layer/Action util/CommonUtil".split(" "),function(y,x,f,u,A,r,n){Object.defineProperty(x,"__esModule",{value:!0});x.uc=x.Ha=void 0;y=function(){function e(a,b,h,t,w){this.Z="21";this.m=20;this.Va=100;this.Fa=10;this.$c=new f.h(0,0);this.i=[];this.Wa=10;this.Fb=null;this.type=0;this.lineWidth=2;this.strokeStyle="#000";this.ra=null;this.Qa=this.Na=-1;this.Vb=!1;this.F=this.o=this.fromPoint=this.v=null;
this.fa={};this.id=a;this.from=b;this.g=h;this.type=t;this.D=new u.jc(this.g,10,14,3);this.D.O=!1;this.D.I=!0;this.ic=new f.h(this.from.x,this.from.y);this.Tb=new f.h(this.from.x,this.from.y);this.ma(w);this.ja();this.oa=new u.mc(new f.h(0,0),4,0,2*Math.PI,"#FF6600",1);this.oa.C=!1}e.prototype.clone=function(){return new e(n.K.W(),new f.h(this.from.x,this.from.y),new f.h(this.g.x,this.g.y),this.type)};e.prototype.Vd=function(){this.i[0]||(this.i[0]=new f.h(this.from.x+(this.g.x-this.from.x)/2,this.from.y));
this.i[1]||(this.i[1]=new f.h(this.i[0].x,this.g.y));var a=!1,b=!1;if(this.fromPoint&&this.v)switch(this.fromPoint.R){case 0:this.g.y>this.from.y?(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y-this.Va):(this.i[0].x=this.from.x,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2);a=!0;break;case 1:this.g.x<this.from.x?(this.i[0].x=this.from.x+this.Va,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2):(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y);
a=!0;break;case 2:this.g.y<this.from.y?(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y+this.Va):(this.i[0].x=this.from.x,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2);a=!0;break;case 3:this.g.x>this.from.x?(this.i[0].x=this.from.x-this.Va,this.i[0].y=this.from.y+(this.g.y-this.from.y)/2):(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y),a=!0}if(this.F&&this.o)switch(this.F.R){case 0:this.g.y<this.from.y?(this.from.x>this.g.x?this.i[1].x=this.g.x+
this.o.w/2:this.i[1].x=this.g.x-this.o.w/2,this.i[1].y=this.g.y-this.Va):(this.i[1].x=this.g.x,this.i[1].y=this.g.y+(this.from.y-this.g.y)/2);b=!0;break;case 1:this.g.x>this.from.x?(this.i[1].x=this.g.x+this.Va,this.from.y>this.g.y?this.i[1].y=this.g.y+this.o.w/2:this.i[1].y=this.g.y-this.o.w/2):(this.i[1].x=this.g.x+(this.from.x-this.g.x)/2,this.i[1].y=this.g.y);b=!0;break;case 2:this.g.y>this.from.y?(this.from.x>this.g.x?this.i[1].x=this.g.x+this.o.w/2:this.i[1].x=this.g.x-this.o.w/2,this.i[1].y=
this.g.y+this.Va):(this.i[1].x=this.g.x,this.i[1].y=this.g.y+(this.from.y-this.g.y)/2);b=!0;break;case 3:this.g.x<this.from.x?(this.i[1].x=this.g.x-this.Va,this.from.y>this.g.y?this.i[1].y=this.g.y+this.o.w/2:this.i[1].y=this.g.y-this.o.w/2):(this.i[1].x=this.g.x+(this.from.x-this.g.x)/2,this.i[1].y=this.g.y),b=!0}a||(this.i[0].x=this.from.x+(this.g.x-this.from.x)/2,this.i[0].y=this.from.y);b||(this.i[1].x=this.g.x+(this.from.x-this.g.x)/2,this.i[1].y=this.g.y)};e.prototype.Xd=function(){if(this.v&&
this.fromPoint)if(this.g.y<=this.from.y)if(this.F&&this.o)switch(this.F.R){case 0:var a=this.g.y-this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 1:this.from.x>=this.g.x?this.i.push(new f.h(this.from.x,this.g.y)):(a=this.o.p.y+this.o.j,a=a<this.from.y?this.from.y-Math.min(this.m,(this.from.y-a)/2):this.o.p.y-this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x+this.m,a)),this.i.push(new f.h(this.g.x+this.m,this.g.y)));break;case 2:a=this.g.y+
(this.from.y-this.g.y)/2;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 3:this.from.x<=this.g.x?this.i.push(new f.h(this.from.x,this.g.y)):(a=this.o.p.y+this.o.j,a=a<this.from.y?this.from.y-Math.min(this.m,(this.from.y-a)/2):this.o.p.y-this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x-this.m,a)),this.i.push(new f.h(this.g.x-this.m,this.g.y)))}else this.g.x>this.from.x?this.g.x-this.from.x>this.from.y-this.g.y?(this.D.M=3,this.i.push(new f.h(this.from.x,
this.g.y))):(this.D.M=2,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a))):this.g.x<this.from.x?this.from.x-this.g.x>this.from.y-this.g.y?(this.D.M=1,this.i.push(new f.h(this.from.x,this.g.y))):(this.D.M=2,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a))):this.D.M=2;else if(this.F&&this.o)switch(this.F.R){case 0:a=this.from.y-this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,
a));break;case 1:a=this.from.y-this.m;var b=this.g.x<this.v.p.x?this.g.x+Math.min(this.m,(this.v.p.x-this.g.x)/2):Math.max(this.g.x,this.v.p.x+this.v.w)+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(b,a));this.i.push(new f.h(b,this.g.y));break;case 2:this.from.x>=this.g.x?(b=this.o.p.x+this.o.w,this.v.p.x>b?b+=(this.v.p.x-b)/2:b=Math.min(this.o.p.x,this.v.p.x)-this.m):(b=this.v.p.x+this.v.w,b=this.o.p.x>b?b+(this.o.p.x-b)/2:Math.max(this.o.p.x+this.o.w,this.v.p.x+this.v.w)+this.m);
this.i.push(new f.h(this.from.x,this.from.y-this.m));this.i.push(new f.h(b,this.from.y-this.m));this.i.push(new f.h(b,this.g.y+this.m));this.i.push(new f.h(this.g.x,this.g.y+this.m));break;case 3:b=this.v.p.x+this.v.w,b=this.g.x<=b?Math.min(this.g.x,this.v.p.x)-this.m:this.g.x-Math.min((this.g.x-b)/2,this.m),this.i.push(new f.h(this.from.x,this.from.y-this.m)),this.i.push(new f.h(b,this.from.y-this.m)),this.i.push(new f.h(b,this.g.y))}else a=this.from.y-this.m,this.i.push(new f.h(this.from.x,a)),
this.i.push(new f.h(this.g.x,a)),this.D.M=0};e.prototype.Zd=function(){if(this.v&&this.fromPoint)if(this.g.y>=this.from.y)if(this.F&&this.o)switch(this.F.R){case 0:var a=this.from.y+(this.g.y-this.from.y)/2;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 1:this.from.x>=this.g.x?this.i.push(new f.h(this.from.x,this.g.y)):(a=this.v.p.y+this.v.j,a=a<this.o.p.y?this.from.y+Math.min(this.m,(this.o.p.y-a)/2):this.o.p.y+this.o.j+this.m,this.i.push(new f.h(this.from.x,a)),
this.i.push(new f.h(this.g.x+this.m,a)),this.i.push(new f.h(this.g.x+this.m,this.g.y)));break;case 2:a=this.g.y+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 3:this.from.x<=this.g.x?this.i.push(new f.h(this.from.x,this.g.y)):(a=this.v.p.y+this.v.j,a=a<this.o.p.y?this.from.y+Math.min(this.m,(this.o.p.y-a)/2):this.o.p.y+this.o.j+this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x-this.m,a)),this.i.push(new f.h(this.g.x-this.m,this.g.y)))}else this.g.x>
this.from.x?this.g.x-this.from.x>this.g.y-this.from.y?(this.D.M=3,this.i.push(new f.h(this.from.x,this.g.y))):(this.D.M=0,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a))):this.g.x<this.from.x?this.from.x-this.g.x>this.g.y-this.from.y?(this.D.M=1,this.i.push(new f.h(this.from.x,this.g.y))):(this.D.M=0,a=this.from.y+(this.g.y-this.from.y)/2,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a))):this.D.M=0;else if(this.F&&this.o)switch(this.F.R){case 0:if(this.from.x>=
this.g.x){var b=this.o.p.x+this.o.w;this.v.p.x>b?b+=(this.v.p.x-b)/2:b=Math.min(this.o.p.x,this.v.p.x)-this.m}else b=this.v.p.x+this.v.w,b=this.o.p.x>b?b+(this.o.p.x-b)/2:Math.max(this.o.p.x+this.o.w,this.v.p.x+this.v.w)+this.m;this.i.push(new f.h(this.from.x,this.from.y+this.m));this.i.push(new f.h(b,this.from.y+this.m));this.i.push(new f.h(b,this.g.y-this.m));this.i.push(new f.h(this.g.x,this.g.y-this.m));break;case 1:a=this.from.y+this.m;b=this.g.x<this.v.p.x?this.g.x+Math.min(this.m,(this.v.p.x-
this.g.x)/2):Math.max(this.g.x,this.v.p.x+this.v.w)+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(b,a));this.i.push(new f.h(b,this.g.y));break;case 2:a=this.from.y+this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a));break;case 3:b=this.v.p.x+this.v.w,a=this.from.y+this.m,b=this.g.x<=b?Math.min(this.g.x,this.v.p.x)-this.m:this.g.x-Math.min((this.g.x-b)/2,this.m),this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(b,a)),this.i.push(new f.h(b,this.g.y))}else a=
this.from.y+this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a)),this.D.M=2};e.prototype.Yd=function(){if(this.v&&this.fromPoint)if(this.g.y<=this.from.y)if(this.F&&this.o)switch(this.F.R){case 0:var a=this.from.x<this.o.p.x?this.from.x+Math.min(this.m,(this.o.p.x-this.from.x)/2):Math.max(this.from.x,this.o.p.x+this.o.w)+this.m;var b=this.g.y-this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 1:a=Math.max(this.from.x,
this.g.x)+this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,this.g.y));break;case 2:this.g.x>=this.from.x?this.i.push(new f.h(this.g.x,this.from.y)):(b=this.g.y<this.v.p.y?this.g.y+Math.min((this.v.p.y-this.g.y)/2,this.m):this.v.p.y+this.v.j+this.m,a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 3:this.from.x<=this.g.x?(a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,
this.g.y))):(b=this.o.p.y+this.o.j,b<this.v.p.y?b+=(this.v.p.y-b)/2:b=Math.min(this.o.p.y,this.v.p.y)-this.m,a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x-this.m,this.i.push(new f.h(a,b)),this.i.push(new f.h(a,this.g.y)))}else this.g.x>this.from.x?this.from.y-this.g.y>this.g.x-this.from.x?(this.D.M=2,this.i.push(new f.h(this.g.x,this.from.y))):(this.D.M=3,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,
this.g.y))):(a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)),this.D.M=1);else if(this.F&&this.o)switch(this.F.R){case 0:this.from.x<=this.g.x?this.i.push(new f.h(this.g.x,this.from.y)):(b=this.v.p.y+this.v.j,b=b<this.g.y?this.g.y-Math.min(this.m,(this.g.y-b)/2):this.v.p.y-this.m,a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 1:a=Math.max(this.g.x,this.from.x)+this.m;this.i.push(new f.h(a,
this.from.y));this.i.push(new f.h(a,this.g.y));break;case 2:a=this.from.x<this.o.p.x?this.from.x+Math.min(this.m,(this.o.p.x-this.from.x)/2):Math.max(this.from.x,this.o.p.x+this.o.w)+this.m;b=this.g.y+this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 3:this.from.x<=this.g.x?(a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(b=this.v.p.y+this.v.j,b=b<this.o.p.y?b+(this.o.p.y-b)/
2:Math.min(this.o.p.y+this.o.j,this.v.p.y+this.v.j)+this.m,a=this.from.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x-this.m,this.i.push(new f.h(a,b)),this.i.push(new f.h(a,this.g.y)))}else this.g.x>this.from.x?this.g.y-this.from.y>this.g.x-this.from.x?(this.D.M=0,this.i.push(new f.h(this.g.x,this.from.y))):(this.D.M=3,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(a=this.from.x+this.m,this.i.push(new f.h(a,
this.from.y)),this.i.push(new f.h(a,this.g.y)),this.D.M=1)};e.prototype.$d=function(){if(this.v&&this.fromPoint)if(this.g.y<=this.from.y)if(this.F&&this.o)switch(this.F.R){case 0:var a=this.o.p.x+this.o.w;a=this.from.x>a?this.from.x-Math.min(this.m,(this.from.x-a)/2):Math.min(this.from.x,this.o.p.x)-this.m;var b=this.g.y-this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 1:this.from.x>this.g.x?(a=this.g.x+(this.from.x-this.g.x)/2,this.i.push(new f.h(a,
this.from.y))):(b=this.o.p.y+this.o.j,b=b<this.v.p.y?b+(this.v.p.y-b)/2:Math.max(this.o.p.y+this.o.j,this.v.p.y+this.v.j)+this.m,a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x+this.m,this.i.push(new f.h(a,b)));this.i.push(new f.h(a,this.g.y));break;case 2:this.g.x<=this.from.x?this.i.push(new f.h(this.g.x,this.from.y)):(b=this.g.y<this.v.p.y?this.g.y+Math.min((this.v.p.y-this.g.y)/2,this.m):this.v.p.y+this.v.j+this.m,a=this.from.x-this.m,this.i.push(new f.h(a,
this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 3:a=Math.min(this.from.x,this.g.x)-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))}else this.g.x<this.from.x?this.from.y-this.g.y>this.from.x-this.g.x?(this.D.M=2,this.i.push(new f.h(this.g.x,this.from.y))):(this.D.M=1,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,
this.g.y)),this.D.M=3);else if(this.F&&this.o)switch(this.F.R){case 0:this.from.x>=this.g.x?this.i.push(new f.h(this.g.x,this.from.y)):(b=this.v.p.y+this.v.j,b=b<this.g.y?this.g.y-Math.min(this.m,(this.g.y-b)/2):this.v.p.y-this.m,a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),this.i.push(new f.h(this.g.x,b)));break;case 1:this.from.x>this.g.x?(a=this.g.x+(this.from.x-this.g.x)/2,this.i.push(new f.h(a,this.from.y))):(b=this.v.p.y+this.v.j,b<this.o.p.y?b+=(this.o.p.y-
b)/2:b=Math.min(this.o.p.y,this.v.p.y)-this.m,a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,b)),a=this.g.x+this.m,this.i.push(new f.h(a,b)));this.i.push(new f.h(a,this.g.y));break;case 2:a=this.o.p.x+this.o.w;a=this.from.x>a?this.from.x-Math.min(this.m,(this.from.x-a)/2):Math.min(this.from.x,this.o.p.x)-this.m;b=this.g.y+this.m;this.i.push(new f.h(a,this.from.y));this.i.push(new f.h(a,b));this.i.push(new f.h(this.g.x,b));break;case 3:a=Math.min(this.from.x,this.g.x)-
this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))}else this.g.x<this.from.x?this.g.y-this.from.y>this.from.x-this.g.x?(this.D.M=0,this.i.push(new f.h(this.g.x,this.from.y))):(this.D.M=1,a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y))):(a=this.from.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)),this.D.M=3)};e.prototype.Wd=function(){this.i.length=0;if(this.fromPoint&&this.v)switch(this.fromPoint.R){case 0:this.Xd();
break;case 1:this.Yd();break;case 2:this.Zd();break;case 3:this.$d()}else if(this.F&&this.o)switch(this.F.R){case 0:if(this.g.y>this.from.y)this.from.x!=this.g.x&&this.i.push(new f.h(this.g.x,this.from.y));else{var a=this.g.y-this.m;this.i.push(new f.h(this.from.x,a));this.i.push(new f.h(this.g.x,a))}break;case 1:this.g.x<this.from.x?this.from.y!=this.g.y&&this.i.push(new f.h(this.from.x,this.g.y)):(a=this.g.x+this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)));break;case 2:this.g.y<
this.from.y?this.from.x!=this.g.x&&this.i.push(new f.h(this.g.x,this.from.y)):(a=this.g.y+this.m,this.i.push(new f.h(this.from.x,a)),this.i.push(new f.h(this.g.x,a)));break;case 3:this.g.x>this.from.x?this.from.y!=this.g.y&&this.i.push(new f.h(this.from.x,this.g.y)):(a=this.g.x-this.m,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,this.g.y)))}else this.from.x!=this.g.x&&this.from.y!=this.g.y&&(a=this.from.x+(this.g.x-this.from.x)/2,this.i.push(new f.h(a,this.from.y)),this.i.push(new f.h(a,
this.g.y)))};e.prototype.ma=function(a){if(a)this.i=a;else switch(this.type){case 0:this.Wd();break;case 2:this.Vd();this.ra!=this.g&&this.o||(this.g.x>this.from.x?this.D.M=3:this.g.x<this.from.x&&(this.D.M=1));break;case 3:this.i[0]?(this.i[0].x=this.from.x,this.i[0].y=this.g.y):this.i[0]=new f.h(this.from.x,this.g.y)}this.Mc()};e.prototype.Mc=function(){var a=this.from.x,b=this.from.y;this.g.x<a&&(a=this.g.x);this.g.y<b&&(b=this.g.y);var h=this.from.x,t=this.from.y;this.g.x>h&&(h=this.g.x);this.g.y>
t&&(t=this.g.y);for(var w=0;w<this.i.length;w++){var z=this.i[w];z.x<a&&(a=z.x);z.y<b&&(b=z.y);z.x>h&&(h=z.x);z.y>t&&(t=z.y)}this.ic.x=a;this.ic.y=b;this.Tb.x=h;this.Tb.y=t};e.prototype.show=function(a){a.lineWidth=this.lineWidth;a.strokeStyle=this.strokeStyle;switch(this.type){case 0:var b=this.g.x,h=this.g.y;switch(this.D.M){case 1:b+=this.D.j;break;case 2:h+=this.D.j;break;case 3:b-=this.D.j;break;default:h-=this.D.j}a.beginPath();a.moveTo(this.from.x,this.from.y);if(0<this.i.length)for(var t=
0;t<this.i.length;t++){var w=this.i[t];a.lineTo(w.x,w.y)}a.lineTo(b,h);this.Fb=null;a.stroke();a.closePath();break;case 2:if(1<this.i.length){h=this.g.x;t=this.g.y;switch(this.D.M){case 1:h+=this.D.j;break;case 2:t+=this.D.j;break;case 3:h-=this.D.j;break;default:t-=this.D.j}b=new Path2D;b.moveTo(this.from.x,this.from.y);b.moveTo(this.from.x,this.from.y);b.bezierCurveTo(this.i[0].x,this.i[0].y,this.i[1].x,this.i[1].y,h,t);this.Fb=b;a.stroke(b);a.closePath();this.oa.C&&(a.lineWidth=this.oa.lineWidth,
a.strokeStyle=this.oa.strokeStyle,a.fillStyle=this.oa.strokeStyle,a.beginPath(),a.arc(this.i[0].x,this.i[0].y,this.oa.S,this.oa.Mb,this.oa.Bb),a.fill(),a.closePath(),a.beginPath(),a.moveTo(this.i[0].x,this.i[0].y),a.lineTo(this.from.x,this.from.y),a.stroke(),a.closePath(),a.beginPath(),a.arc(this.i[1].x,this.i[1].y,this.oa.S,this.oa.Mb,this.oa.Bb),a.fill(),a.closePath(),a.beginPath(),a.moveTo(this.i[1].x,this.i[1].y),a.lineTo(this.g.x,this.g.y),a.stroke(),a.closePath())}break;case 3:if(0<this.i.length){h=
this.g.x;t=this.g.y;switch(this.D.M){case 1:h+=this.D.j;break;case 2:t+=this.D.j;break;case 3:h-=this.D.j;break;default:t-=this.D.j}b=new Path2D;b.moveTo(this.from.x,this.from.y);b.quadraticCurveTo(this.i[0].x,this.i[0].y,h,t);this.Fb=b;a.stroke(b)}}this.D.sa(a,this.$c)};e.prototype.onclick=function(a){var b=!1;a.Zb();a.tb==this?(a.ga=this,a.anchorNode&&a.anchorNode instanceof A.wa&&(a.anchorNode.td(),a.L=!0,a.anchorNode=null),b=!0,a.L=!0,this.oa.C=!0):a.ga=null;return b};e.prototype.ondblclick=function(){return!1};
e.prototype.onmousedown=function(a){if(!a.A||!a.U)return!1;var b=a.G.x,h=a.G.y,t=!1;Math.abs(b-this.from.x)<this.Fa&&Math.abs(h-this.from.y)<this.Fa?(this.ra=this.from,t=!0):Math.abs(b-this.g.x)<this.Fa&&Math.abs(h-this.g.y)<this.Fa&&(this.ra=this.g,t=!0);t?a.xa=this:(this.ra=null,a.xa==this&&(a.xa=null),a.tb==this&&(t=!0,this.Vb=-1<this.Na||-1<this.Qa?!0:!1));return t};e.prototype.onmouseup=function(a){var b=!1;if(a.xa==this){if(this.ra){a.Zb();this.oa.C=!0;a.tb=this;a.ga=this;if(this.ra==this.from||
this.ra==this.g){b=a.G.x;for(var h=a.G.y,t=!1,w=a.J.length-1;-1<w;w--){var z=a.J[w];if(z instanceof A.wa)for(var B=0;B<z.qa.length;B++){var D=z.qa[B];if(Math.abs(z.p.x+D.l.x-b)<D.Rb&&Math.abs(z.p.y+D.l.y-h)<D.Rb){t=!0;this.ra==this.from?z.Xc(this,D.l,D.R):z.Yc(this,D.l,D.R);break}}}t||(this.ra==this.from?this.v&&(this.v.Bc(this),this.ma()):this.o&&(this.o.Cc(this),this.ma()));a.L=!0}a.zb&&(a.zb=!1,b=new e("-1",new f.h(0,0),new f.h(0,0),0),b.id=this.id,a.ta(new r.Ob(b)))}b=!0}a.Xa=!1;this.ra=null;
this.Qa=this.Na=-1;this.Vb=!1;a.xa=null;a.va.v=null;a.va.fromPoint=null;return b};e.prototype.$a=function(a){var b=a.G.x,h=a.G.y;return 1==a.Cb&&this.ra?(a.Xa||(a.Xa=!0,a.ta(new r.Pb(this))),this.ra.x=b,this.ra.y=h,this.ma(),a.L=!0):!1};e.prototype.Td=function(a){var b=a.G.x,h=a.G.y;if(1==a.Cb&&-1<this.Na&&this.Na<this.i.length){a.Xa||(a.Xa=!0,a.ta(new r.Pb(this)));var t=this.i[this.Na],w=this.i[this.Na+1];t.x==w.x?(t.x=b,w.x=b):(t.y=h,w.y=h);this.Mc();a.L=!0}};e.prototype.Ud=function(a){var b=a.G.x,
h=a.G.y;if(1==a.Cb&&-1<this.Qa&&this.Qa<this.i.length){a.Xa||(a.Xa=!0,a.ta(new r.Pb(this)));var t=this.i[this.Qa];t.x=b;t.y=h;this.Mc();a.L=!0}};e.prototype.onmousemove=function(a){if(!a.A||!a.U)return!1;var b=a.G.x,h=a.G.y,t=!1;Math.abs(b-this.from.x)<this.Fa&&Math.abs(h-this.from.y)<this.Fa?t=!0:Math.abs(b-this.g.x)<this.Fa&&Math.abs(h-this.g.y)<this.Fa&&(t=!0);if(t)a.A.style.cursor!=f.$.move&&(a.A.style.cursor=f.$.move);else{var w=!0;if(0==this.type){b=this.from;if(0<this.i.length)for(h=0;h<this.i.length;h++){var z=
this.i[h];if(t=this.kd(a.G,b,z)){b!=this.from&&(this.Na=h-1,w=!1,b.x==z.x?a.A.style.cursor!=f.$.wd&&(a.A.style.cursor=f.$.wd):a.A.style.cursor!=f.$.ud&&(a.A.style.cursor=f.$.ud));break}b=z}t||(t=this.kd(a.G,b,this.g))}else 2==this.type&&(a.ga==this&&Math.abs(b-this.i[0].x)<this.Wa&&Math.abs(h-this.i[0].y)<this.Wa?(this.Qa=0,t=!0):a.ga==this&&Math.abs(b-this.i[1].x)<this.Wa&&Math.abs(h-this.i[1].y)<this.Wa?(t=!0,this.Qa=1):(z=window.devicePixelRatio,this.Fb&&a.U.isPointInStroke(this.Fb,b*z,h*z)&&(t=
!0)));t&&w&&a.A.style.cursor!=f.$.sd&&(a.A.style.cursor=f.$.sd)}t?a.tb=this:(a.tb=null,this.Na=-1);return t};e.prototype.kd=function(a,b,h){var t;void 0===t&&(t=3);var w=!1;if(b.x!=h.x){var z=Math.min(b.x,h.x),B=Math.max(b.x,h.x);if(a.x>=z&&a.x<=B){var D=b.y;if(b.y!=h.y){var H=z==b.x?b:h;b=H==b?h:b;D=(a.x-H.x)*(b.y-H.y)/(b.x-H.x);D=H.y+D}a.x>=z&&a.x<=B&&Math.abs(a.y-D)<=t&&(w=!0)}}else b.y!=h.y&&(z=Math.min(b.y,h.y),B=Math.max(b.y,h.y),a.y>=z&&a.y<=B&&Math.abs(a.x-b.x)<=t&&(w=!0));return w};e.prototype.dc=
function(a){var b=a.G.x,h=a.G.y,t=!1;this.v;!this.v&&Math.abs(b-this.from.x)<this.Fa&&Math.abs(h-this.from.y)<this.Fa?t=!0:!this.o&&Math.abs(b-this.g.x)<this.Fa&&Math.abs(h-this.g.y)<this.Fa?t=!0:2==this.type&&a.ga==this&&(Math.abs(b-this.i[0].x)<this.Wa&&Math.abs(h-this.i[0].y)<this.Wa?t=!0:Math.abs(b-this.i[1].x)<this.Wa&&Math.abs(h-this.i[1].y)<this.Wa&&(t=!0));return t};e.prototype.pa=function(a){if(1==a.Cb&&a.Db==f.ea.md){if(this.ra)return this.$a(a),!0;if(this.Vb&&-1<this.Na&&0==this.type)return this.Td(a),
!0;if(this.Vb&&-1<this.Qa&&2==this.type)return this.Ud(a),!0}if(a.Db==f.ea.nd)return this.onmouseup(a);var b=a.G.x,h=a.G.y;if(this.dc(a)||b>=this.ic.x&&h>=this.ic.y&&b<=this.Tb.x&&h<=this.Tb.y)if(b=this.fa["on"+a.Db])return b.call(this,a);this.Qa=this.Na=-1;"mouseup"==a.Db&&a.Zb();return!1};e.prototype.ja=function(){this.fa.onclick=this.onclick;this.fa.ondblclick=this.ondblclick;this.fa.onmousedown=this.onmousedown;this.fa.onmouseup=this.onmouseup;this.fa.onmousemove=this.onmousemove;this.fa.ondragmousemove=
this.$a};return e}();x.Ha=y;y=function(e){function a(b,h,t,w,z){b=e.call(this,b,h,t,w,z)||this;b.Z="22";b.u=new u.Qb(null,new f.h(0,0),[],80);b.u.Ac=!1;b.u.Pd=!0;b.u.fillStyle="#9966FF";b.u.strokeStyle="#9966FF";return b}Y(a,e);a.prototype.ondblclick=function(b){if(b.tb!=this)return!1;this.Nc();if(b.N){b.N.textContent="";if(0<this.u.text.length)for(var h=0;h<this.u.text.length;h++){var t=this.u.text[h],w=document.createElement("div");t?w.textContent=t:w.innerHTML="<br>";b.N.appendChild(w)}b.Za.x=
this.u.l.x;b.Za.y=this.u.l.y;b.N.style.top=this.u.l.y+"px";b.N.style.left=this.u.l.x+"px";b.N.style.fontSize=this.u.fontSize+"px";b.N.style.fontFamily=this.u.fontFamily;b.N.style.color=this.u.fillStyle;b.N.style.visibility="visible";b.N.focus();if(h=window.getSelection())h.selectAllChildren(b.N),h.collapseToEnd();this.u.C=!1;b.Ra=this;b.fb=null;b.L=!0;b.qb.x=b.N.offsetWidth;b.qb.y=b.N.offsetHeight;return!0}return!1};a.prototype.ma=function(b){e.prototype.ma.call(this,b);this.u&&0<this.u.text.length&&
this.Nc()};a.prototype.Nc=function(){if(this.u)switch(this.type){case 0:this.ce();break;case 2:this.ae()}};a.prototype.ce=function(){if(0==this.i.length)this.from.x==this.g.x?(this.u.l.x=this.from.x,this.u.l.y=this.from.y+(this.g.y-this.from.y)/2):(this.u.l.y=this.from.y,this.u.l.x=this.from.x+(this.g.x-this.from.x)/2);else{for(var b=this.from,h=0,t=[],w=0,z=this.i.length;w<z;w++){var B=this.i[w];h=B.x==b.x?h+Math.abs(B.y-b.y):h+Math.abs(B.x-b.x);t[w]=h;b=B}h=this.g.x==b.x?h+Math.abs(this.g.y-b.y):
h+Math.abs(this.g.x-b.x);h/=2;b=0;for(z=t.length;b<z&&!(t[b]>h);b++);0==b?(z=this.from,w=this.i[0]):(z=this.i[b-1],w=b<this.i.length?this.i[b]:this.g,h-=t[b-1]);z.x==w.x?(this.u.l.x=z.x,w.y>z.y?this.u.l.y=z.y+h:this.u.l.y=z.y-h):(this.u.l.y=z.y,w.x>z.x?this.u.l.x=z.x+h:this.u.l.x=z.x-h);this.u.l.x-=this.u.Sa/2;this.u.l.y-=this.u.$b/2}};a.prototype.ae=function(){var b=this.g.x,h=this.g.y;switch(this.D.M){case 1:b+=this.D.j;break;case 2:h+=this.D.j;break;case 3:b-=this.D.j;break;default:h-=this.D.j}this.u.l.x=
.125*this.from.x+.375*this.i[0].x+.375*this.i[1].x+.125*b;this.u.l.y=.125*this.from.y+.375*this.i[0].y+.375*this.i[1].y+.125*h;this.u.l.x-=this.u.Sa/2;this.u.l.y-=this.u.$b/2};a.prototype.show=function(b){e.prototype.show.call(this,b);this.u&&this.u.C&&0<this.u.text.length&&this.u.sa(b,this.$c)};a.prototype.clone=function(){var b=new a(n.K.W(),new f.h(this.from.x,this.from.y),new f.h(this.g.x,this.g.y),this.type);b.u.Lb(this.u.text.slice(0));return b};return a}(y);x.uc=y});
define("core/base/Node",["require","exports","core/base/BaseBean","core/base/BaseShape","util/CommonUtil"],function(y,x,f,u,A){Object.defineProperty(x,"__esModule",{value:!0});x.cb=x.wa=x.Node=void 0;y=function(){function r(n,e,a,b){this.Z="1";this.pb=new f.h(0,0);this.Gb=new f.h(0,0);this.sb=[];this.fa={};this.id=n;this.p=e;this.w=a;this.j=b;this.ja()}r.prototype.zd=function(n){this.sb.push(n)};r.prototype.lb=function(n){this.sb.splice(0,0,n)};r.prototype.show=function(n){if(this.sb)for(var e=0;e<
this.sb.length;e++)this.sb[e].C&&this.sb[e].sa(n,this.p)};r.prototype.pa=function(n,e){(e=this.fa[e])&&e.call(this,n)};r.prototype.onmousedown=function(n){var e=n.G.x,a=n.G.y;this.Gb.x=e;this.Gb.y=a;this.pb.x=this.p.x-e;this.pb.y=this.p.y-a;n.Ya=this};r.prototype.$a=function(n){var e=n.G.y;this.p.x=n.G.x+this.pb.x;this.p.y=e+this.pb.y;n.L=!0};r.prototype.scale=function(n,e){this.w=n;this.j=e};r.prototype.ja=function(){this.fa.onmousedown=this.onmousedown;this.fa.ondragmousemove=this.$a};r.prototype.clone=
function(){return new r(A.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j)};return r}();x.Node=y;y=function(r){function n(e,a,b,h){e=r.call(this,e,a,b,h)||this;e.ne=4;e.fc=6;e.oe=.5*e.fc;e.pe=1.5*e.fc;e.Ib="#990000";e.Ta=[];e.qa=[];e.rb=null;e.Y="#FF3300";e.X=4;e.Ia=0;e.na=20;e.ia=[];e.ha=[];e.ib=new f.h(1,1);a=e.fc;e.ob=new u.Rect(new f.h(0,0),e.w,e.j,e.Ib);e.Ga=new u.Rect(new f.h(-a/2,-a/2),a,a,e.Ib);e.Ea=new u.Rect(new f.h(b-a/2,-a/2),a,a,e.Ib);e.ya=new u.Rect(new f.h(-a/2,h-a/2),a,a,e.Ib);e.za=
new u.Rect(new f.h(b-a/2,h-a/2),a,a,e.Ib);e.ob.I=!1;e.ob.C=!1;e.Ga.I=!0;e.Ga.C=!1;e.Ga.fillStyle="#FFFFFF";e.Ea.I=!0;e.Ea.C=!1;e.Ea.fillStyle="#FFFFFF";e.ya.I=!0;e.ya.C=!1;e.ya.fillStyle="#FFFFFF";e.za.I=!0;e.za.C=!1;e.za.fillStyle="#FFFFFF";e.Ta.push(e.ob);e.Ta.push(e.Ga);e.Ta.push(e.Ea);e.Ta.push(e.ya);e.Ta.push(e.za);return e}Y(n,r);n.prototype.clone=function(){return new n(A.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j)};n.prototype.vc=function(e,a){this.Xc(e,a,a.R)};n.prototype.Xc=function(e,
a,b){void 0===b&&(b=0);e.v&&e.v==this||(e.v&&e.v.Bc(e),e.v=this);e.fromPoint=new f.bb(a.x,a.y,b);e.from.x=this.p.x+a.x;e.from.y=this.p.y+a.y;e.ma();0>this.ia.indexOf(e)&&this.ia.push(e)};n.prototype.Bc=function(e,a){void 0===a&&(a=!0);a&&(e.fromPoint=null,e.v=null);e=this.ia.indexOf(e);0<=e&&this.ia.splice(e,1)};n.prototype.Zc=function(e,a){this.Yc(e,a,a.R)};n.prototype.Yc=function(e,a,b){void 0===b&&(b=0);e.o&&e.o==this||(e.o&&e.o.Cc(e),e.o=this);e.F=new f.bb(a.x,a.y,b);e.g.x=this.p.x+a.x;e.g.y=
this.p.y+a.y;e.D.M=b;e.ma();0>this.ha.indexOf(e)&&this.ha.push(e)};n.prototype.Cc=function(e,a){void 0===a&&(a=!0);a&&(e.F=null,e.o=null);e=this.ha.indexOf(e);0<=e&&this.ha.splice(e,1)};n.prototype.show=function(e){r.prototype.show.call(this,e);if(this.Ta)for(var a=0;a<this.Ta.length;a++)this.Ta[a].C&&this.Ta[a].sa(e,this.p);if(this.qa)for(a=0;a<this.qa.length;a++)this.qa[a].C&&this.qa[a].sa(e,this.p)};n.prototype.ub=function(e){e&&0<e.length&&(this.qa=e)};n.prototype.onmouseenter=function(e){e.anchorNode!=
this&&(this.fd(),e.L=!0)};n.prototype.onmouseleave=function(e){e.anchorNode!=this&&(this.gd(),e.L=!0)};n.prototype.cc=function(e){this.td();this.gd();e.L=!0};n.prototype.bc=function(e){this.fe();this.fd();e.L=!0};n.prototype.dc=function(e){this.Ia=0;var a=e.G.x-this.p.x;e=e.G.y-this.p.y;var b=!0;if(a>=this.za.l.x&&a<=this.za.l.x+this.za.w&&e>=this.za.l.y&&e<=this.za.l.y+this.za.j)this.Ia=3;else if(a>=this.Ga.l.x&&a<=this.Ga.l.x+this.Ga.w&&e>=this.Ga.l.y&&e<=this.Ga.l.y+this.Ga.j)this.Ia=1;else if(a>=
this.Ea.l.x&&a<=this.Ea.l.x+this.Ea.w&&e>=this.Ea.l.y&&e<=this.Ea.l.y+this.Ea.j)this.Ia=2;else if(a>=this.ya.l.x&&a<=this.ya.l.x+this.ya.w&&e>=this.ya.l.y&&e<=this.ya.l.y+this.ya.j)this.Ia=4;else if(b=!1,0<this.qa.length){this.rb=null;for(var h=0;h<this.qa.length;h++){var t=this.qa[h];if(Math.abs(a-t.l.x)<t.Rb&&Math.abs(e-t.l.y)<t.Rb)return this.Ia=5,this.rb=t,!0}}return b};n.prototype.onmousemove=function(e){if(e.A)switch(this.Ia){case 3:e.A.style.cursor!=f.$.hc&&(e.A.style.cursor=f.$.hc);break;
case 1:e.A.style.cursor!=f.$.hc&&(e.A.style.cursor=f.$.hc);break;case 2:e.A.style.cursor!=f.$.ac&&(e.A.style.cursor=f.$.ac);break;case 4:e.A.style.cursor!=f.$.ac&&(e.A.style.cursor=f.$.ac);break;case 5:e.A.style.cursor!=f.$.ed&&(e.A.style.cursor=f.$.ed);break;default:e.A.style.cursor!=f.$.move&&(e.A.style.cursor=f.$.move)}};n.prototype.onmousedown=function(e){5==this.Ia&&this.rb?(e.va.v=this,e.va.fromPoint=new f.bb(this.rb.l.x,this.rb.l.y,this.rb.R)):r.prototype.onmousedown.call(this,e)};n.prototype.$a=
function(e){0==this.Ia?(r.prototype.$a.call(this,e),this.nb()):5>this.Ia&&this.ge(e.G,this.Gb)&&(this.Gb.x=e.G.x,this.Gb.y=e.G.y,e.L=!0)};n.prototype.fe=function(){this.ob.C=!0;this.Ga.C=!0;this.Ea.C=!0;this.ya.C=!0;this.za.C=!0};n.prototype.td=function(){this.ob.C=!1;this.Ga.C=!1;this.Ea.C=!1;this.ya.C=!1;this.za.C=!1};n.prototype.fd=function(){for(var e=0;e<this.qa.length;e++)this.qa[e].C=!0};n.prototype.gd=function(){for(var e=0;e<this.qa.length;e++)this.qa[e].C=!1};n.prototype.ge=function(e,a){switch(this.Ia){case 1:var b=
e.x;e=e.y;if(b>this.p.x+this.w-this.na||e>this.p.y+this.j-this.na)return!1;var h=b-a.x,t=e-a.y;this.p.x+=h;this.p.y+=t;h=this.w-h;t=this.j-t;if(h<this.na||t<this.na)return!1;this.scale(h,t);break;case 2:b=e.x;e=e.y;if(b<this.p.x+this.na||e>this.p.y+this.j-this.na)return!1;t=e-a.y;this.p.y+=t;h=this.w+b-a.x;t=this.j-t;a.x=b;a.y=e;if(h<this.na||t<this.na)return!1;this.scale(h,t);break;case 3:b=e.x;e=e.y;if(b<this.p.x+this.na||e<this.p.y+this.na)return!1;h=this.w+b-a.x;t=this.j+e-a.y;a.x=b;a.y=e;if(h<
this.na||t<this.na)return!1;this.scale(h,t);break;case 4:b=e.x;e=e.y;if(b>this.p.x+this.w-this.na||e<this.p.y+this.na)return!1;h=b-a.x;this.p.x+=h;h=this.w-h;t=this.j+e-a.y;a.x=b;a.y=e;if(h<this.na||t<this.na)return!1;this.scale(h,t);break;default:return!1}return!0};n.prototype.scale=function(e,a){this.ib.x=e/this.w;this.ib.y=a/this.j;r.prototype.scale.call(this,e,a);e=this.fc;this.ob.scale(this.w,this.j,!1);this.Ea.P(this.w-e/2,-e/2);this.ya.P(-e/2,this.j-e/2);this.za.P(this.w-e/2,this.j-e/2);0<
this.qa.length&&this.eb();this.xc()};n.prototype.nb=function(){if(0<this.ia.length)for(var e=0;e<this.ia.length;e++){var a=this.ia[e];a.fromPoint&&(a.from.x=this.p.x+a.fromPoint.x,a.from.y=this.p.y+a.fromPoint.y,a.ma())}if(0<this.ha.length)for(e=0;e<this.ha.length;e++)a=this.ha[e],a.F&&(a.g.x=this.p.x+a.F.x,a.g.y=this.p.y+a.F.y,a.ma())};n.prototype.xc=function(){if(0<this.ia.length)for(var e=0;e<this.ia.length;e++){var a=this.ia[e];a.fromPoint&&(a.fromPoint.x*=this.ib.x,a.fromPoint.y*=this.ib.y,a.from.x=
this.p.x+a.fromPoint.x,a.from.y=this.p.y+a.fromPoint.y,a.ma())}if(0<this.ha.length)for(e=0;e<this.ha.length;e++)a=this.ha[e],a.F&&(a.F.x*=this.ib.x,a.F.y*=this.ib.y,a.g.x=this.p.x+a.F.x,a.g.y=this.p.y+a.F.y,a.ma())};n.prototype.eb=function(){};n.prototype.ja=function(){r.prototype.ja.call(this);this.fa.onmouseenter=this.onmouseenter;this.fa.onmouseleave=this.onmouseleave;this.fa.onunanchor=this.cc;this.fa.onanchor=this.bc;this.fa.onmousemove=this.onmousemove};return n}(y);x.wa=y;y=function(r){function n(e,
a,b,h,t){e=r.call(this,e,a,b,h)||this;e.u=new u.Qb(e,new f.h(0,0),t?t:[],e.w);e.u.I=!0;e.u.O=!1;e.u.fillStyle="#000000";e.zd(e.u);return e}Y(n,r);n.prototype.clone=function(){return new n(A.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.u?this.u.text.slice(0):[])};n.prototype.Lb=function(e){var a;null===(a=this.u)||void 0===a?void 0:a.Lb(e)};n.prototype.scale=function(e,a){r.prototype.scale.call(this,e,a);this.u&&this.u.scale(this.u.w*this.ib.x)};n.prototype.ondblclick=function(e){if(e.T){if(0<
this.u.text.length){e.T.textContent="";for(var a=0;a<this.u.text.length;a++){var b=this.u.text[a],h=document.createElement("div");b?h.textContent=b:h.innerHTML="<br>";e.T.appendChild(h)}}else e.T.textContent="";e.T.style.top=this.p.y+this.u.l.y+"px";e.T.style.left=this.p.x+"px";e.T.style.width=this.u.w+"px";e.T.style.minHeight=this.j-this.u.l.y+"px";e.T.style.fontSize=this.u.fontSize+"px";e.T.style.fontFamily=this.u.fontFamily;e.T.style.visibility="visible";e.T.focus();if(a=window.getSelection())a.selectAllChildren(e.T),
a.collapseToEnd();this.u.C=!1;e.fb=this;e.Ra=null;e.L=!0}};return n}(y);x.cb=y});
define("core/base/BaseShape",["require","exports","core/base/Pen"],function(y,x,f){Object.defineProperty(x,"__esModule",{value:!0});x.Qb=x.V=x.mc=x.qc=x.lc=x.Rect=x.vb=x.Wc=x.jc=void 0;y=function(u){function A(r,n,e,a){void 0===a&&(a=0);var b=u.call(this)||this;b.Ba=[5,5];b.Da=[];b.Ca=!1;b.M=0;b.Z="32";b.w=n;b.j=e;b.ab=n/2;b.me=e/2;b.l=r;b.M=a;return b}Y(A,u);A.prototype.show=function(r,n){if(r&&(this.I||this.O)){r.beginPath();r.lineCap="square";this.Ca?r.setLineDash(this.Ba):r.setLineDash(this.Da);
switch(this.M){case 1:var e=this.l.y+this.ab;var a=this.l.x+this.j;var b=this.l.y-this.ab;var h=this.l.x+this.j;break;case 2:e=this.l.y+this.j;a=this.l.x+this.ab;b=this.l.y+this.j;h=this.l.x-this.ab;break;case 3:e=this.l.y+this.ab;a=this.l.x-this.j;b=this.l.y-this.ab;h=this.l.x-this.j;break;default:e=this.l.y-this.j,a=this.l.x-this.ab,b=this.l.y-this.j,h=this.l.x+this.ab}r.moveTo(n.x+this.l.x,n.y+this.l.y);r.lineTo(n.x+a,n.y+e);r.lineTo(n.x+h,n.y+b);r.closePath();this.I&&r.fill();this.O&&r.stroke()}};
return A}(f.Oa);x.jc=y;y=function(u){function A(r,n,e){var a=u.call(this)||this;a.Ba=[5,5];a.Da=[];a.Ca=!1;a.Z="33";a.l=r;a.qd=n;a.rd=e;return a}Y(A,u);A.prototype.show=function(r,n){r&&(this.I||this.O)&&(r.beginPath(),r.lineCap="square",this.Ca?r.setLineDash(this.Ba):r.setLineDash(this.Da),r.moveTo(n.x+this.l.x,n.y+this.l.y),r.lineTo(n.x+this.qd.x,n.y+this.qd.y),r.lineTo(n.x+this.rd.x,n.y+this.rd.y),this.I&&r.fill(),this.O&&r.stroke(),r.closePath())};return A}(f.Oa);x.Wc=y;y=function(u){function A(r){var n=
u.call(this)||this;n.Ba=[5,5];n.Da=[];n.Ca=!1;n.H=[];n.lineCap="square";n.lineJoin="miter";n.Z="34";n.H=r;return n}Y(A,u);A.prototype.show=function(r,n){if(r&&(this.I||this.O)&&this.H&&1<this.H.length){r.beginPath();r.lineCap=this.lineCap;r.lineJoin=this.lineJoin;this.Ca?r.setLineDash(this.Ba):r.setLineDash(this.Da);for(var e=0,a=this.H.length;e<a;e++)0==e?r.moveTo(n.x+this.H[0].x,n.y+this.H[0].y):r.lineTo(n.x+this.H[e].x,n.y+this.H[e].y),e+2<a&&1==this.H[e].type&&1==this.H[e+1].type&&1==this.H[e+
2].type&&(e+3<a&&1==this.H[e+3].type?(r.bezierCurveTo(n.x+this.H[e+1].x,n.y+this.H[e+1].y,n.x+this.H[e+2].x,n.y+this.H[e+2].y,n.x+this.H[e+3].x,n.y+this.H[e+3].y),e+=3):(r.quadraticCurveTo(n.x+this.H[e+1].x,n.y+this.H[e+1].y,n.x+this.H[e+2].x,n.y+this.H[e+2].y),e+=2));this.I&&r.fill();this.O&&r.stroke();r.closePath()}};return A}(f.Oa);x.vb=y;y=function(u){function A(r,n,e,a){var b=u.call(this)||this;b.Ba=[5,5];b.Da=[];b.Ca=!1;b.Z="35";b.l=r;b.w=n;b.j=e;a&&(b.strokeStyle=a);return b}Y(A,u);A.prototype.show=
function(r,n){r&&(this.I||this.O)&&this.l&&this.w&&this.j&&(r.beginPath(),r.lineCap="square",this.Ca?r.setLineDash(this.Ba):r.setLineDash(this.Da),this.I&&r.fillRect(n.x+this.l.x,n.y+this.l.y,this.w,this.j),this.O&&r.strokeRect(n.x+this.l.x,n.y+this.l.y,this.w,this.j),r.closePath())};A.prototype.scale=function(r,n,e){void 0===e&&(e=!0);e?(this.w=this.w*r,this.j=this.j*n):(this.w=r,this.j=n)};A.prototype.P=function(r,n){this.l.x=r;this.l.y=n};return A}(f.Oa);x.Rect=y;y=function(u){function A(r,n,e,
a){var b=u.call(this)||this;b.S=0;b.Ba=[5,5];b.Da=[];b.Ca=!1;b.Z="36";b.l=r;b.w=n;b.j=e;r=Math.min(n,e);a&&a<r&&(b.S=a);0>=b.S&&(b.S=r/3);return b}Y(A,u);A.prototype.show=function(r,n){if(r&&(this.I||this.O)&&this.l&&this.w&&this.j){r.beginPath();r.lineCap="round";this.Ca?r.setLineDash(this.Ba):r.setLineDash(this.Da);var e=n.x+this.l.x;n=n.y+this.l.y;r.moveTo(e+this.S,n);r.lineTo(e+this.w-this.S,n);r.quadraticCurveTo(e+this.w,n,e+this.w,n+this.S);r.lineTo(e+this.w,n+this.j-this.S);r.quadraticCurveTo(e+
this.w,n+this.j,e+this.w-this.S,n+this.j);r.lineTo(e+this.S,n+this.j);r.quadraticCurveTo(e,n+this.j,e,n+this.j-this.S);r.lineTo(e,n+this.S);r.quadraticCurveTo(e,n,e+this.S,n);this.I&&r.fill();this.O&&r.stroke();r.closePath()}};A.prototype.scale=function(r,n,e,a){void 0===e&&(e=!0);e?(this.w=this.w*r,this.j=this.j*n,a&&(this.S=this.S*a)):(this.w=r,this.j=n,a&&(this.S=a))};A.prototype.P=function(r,n){this.l.x=r;this.l.y=n};return A}(f.Oa);x.lc=y;y=function(u){function A(r,n,e,a,b,h,t){void 0===e&&(e=
0);void 0===a&&(a=2*Math.PI);void 0===b&&(b=0);var w=u.call(this)||this;w.Ba=[5,5];w.Da=[];w.Ca=!1;w.Z="37";w.l=r;w.S=n;w.Mb=e;w.Bb=a;w.rotation=b;h&&(w.strokeStyle=h);t&&(w.lineWidth=t);return w}Y(A,u);A.prototype.show=function(r,n){r&&(this.I||this.O)&&(r.beginPath(),r.lineCap="round",this.Ca?r.setLineDash(this.Ba):r.setLineDash(this.Da),r.ellipse(n.x+this.l.x,n.y+this.l.y,this.S.x,this.S.y,this.rotation,this.Mb,this.Bb),this.I&&r.fill(),this.O&&r.stroke(),r.closePath())};A.prototype.P=function(r,
n){this.l.x=r;this.l.y=n};return A}(f.Oa);x.qc=y;y=function(u){function A(r,n,e,a,b,h){void 0===e&&(e=0);void 0===a&&(a=2*Math.PI);var t=u.call(this)||this;t.Ba=[5,5];t.Da=[];t.Ca=!1;t.Z="38";t.l=r;t.S=n;t.Mb=e;t.Bb=a;b&&(t.strokeStyle=b);h&&(t.lineWidth=h);return t}Y(A,u);A.prototype.show=function(r,n){r&&(this.I||this.O)&&(r.beginPath(),r.lineCap="round",this.Ca?r.setLineDash(this.Ba):r.setLineDash(this.Da),r.arc(n.x+this.l.x,n.y+this.l.y,this.S,this.Mb,this.Bb),this.I&&r.fill(),this.O&&r.stroke(),
r.closePath())};A.prototype.scale=function(r,n){void 0===n&&(n=!0);n?(r=this.S*r,this.l.x=this.l.x+r-this.S,this.l.y=this.l.y+r-this.S,this.S=r):(this.l.x=this.l.x+r-this.S,this.l.y=this.l.y+r-this.S,this.S=r)};A.prototype.P=function(r,n){this.l.x=r;this.l.y=n};return A}(f.Oa);x.mc=y;y=function(u){function A(r,n,e,a,b,h,t){void 0===e&&(e=0);void 0===a&&(a=2*Math.PI);void 0===b&&(b=0);r=u.call(this,r,n,e,a,h,t)||this;r.Z="39";r.R=b;r.Rb=2*n;return r}Y(A,u);return A}(y);x.V=y;f=function(u){function A(r,
n,e,a){var b=u.call(this)||this;b.jb=[];b.La=[];b.Eb=!1;b.fontSize=20;b.fontFamily="Microsoft YaHei";b.Lc=0;b.Kc=.3;b.Ac=!0;b.Pd=!0;b.he=0;b.Sa=0;b.$b=0;b.Z="391";b.parent=r;b.l=n;b.text=e;b.w=a;b.I=!0;b.O=!1;b.vd();return b}Y(A,u);A.prototype.Lb=function(r){this.Eb=!1;this.text=r};A.prototype.jd=function(r){if(!this.Eb){this.Eb=!0;this.$b=this.Sa=0;var n=this.jb;n.length=0;this.La.length=0;if(0<this.text.length){for(var e=0;e<this.text.length;e++){var a=this.text[e];if(a){var b=r.measureText(a).width;
if(this.Ac){var h=a.length;this.he=b;var t=Math.floor(this.w/(b/h));b=0;for(var w,z,B;b<h;){w=b+Math.min(h-b,t);z=a.substring(b,w);B=r.measureText(z).width;if(B>this.w)for(;b<w&&B>this.w;)w--,z=a.substring(b,w),B=r.measureText(z).width;else if(B<this.w)for(var D,H;w<h;)if(w++,H=a.substring(b,w),D=r.measureText(z).width,D<this.w)z=H,B=D;else if(D==this.w){z=H;B=D;break}else if(D>this.w){w--;break}n.push(z);B>this.Sa&&(this.Sa=B);B>=this.w?this.La.push(0):this.La.push((this.w-B)/2);b=w}}else n.push(a),
b>this.Sa&&(this.Sa=b),this.La.push(b)}else n.push(""),this.La.push(0)}this.$b=(n.length-1)*(this.fontSize*(1+this.Kc)+this.Lc)+this.fontSize;if(!this.Ac)for(b=0,r=this.La.length;b<r;b++)this.La[b]=this.La[b]>=this.Sa?0:(this.Sa-this.La[b])/2}this.vd()}};A.prototype.vd=function(){if(this.parent){var r=this.fontSize*(1+this.Kc)+this.Lc,n=this.fontSize;1<this.jb.length&&(n=this.fontSize+(this.jb.length-1)*r);n<this.parent.j?(this.l.y=(this.parent.j-n)/2-5,0>this.l.y&&(this.l.y=0)):this.l.y=0}};A.prototype.show=
function(r,n){if(r&&(this.I||this.O)&&(r.font=this.fontSize+"px "+this.fontFamily,this.Eb||this.jd(r),this.text)){r.beginPath();var e=this.fontSize*(1+this.Kc)+this.Lc;if(this.I)for(var a=this.fontSize,b=0;b<this.jb.length;b++)r.fillText(this.jb[b],n.x+this.l.x+this.La[b],n.y+this.l.y+a),a+=e;if(this.O)for(a=this.fontSize,b=0;b<this.jb.length;b++)r.strokeText(this.jb[b],n.x+this.l.x+this.La[b],n.y+this.l.y+a),a+=e;r.closePath()}};A.prototype.scale=function(r){this.w=r;this.Eb=!1};A.prototype.P=function(r,
n){this.l.x=r;this.l.y=n};return A}(f.Oa);x.Qb=f});
define("process/ProcProc","require exports core/base/BaseBean core/base/BaseShape core/base/Node util/CommonUtil".split(" "),function(y,x,f,u,A,r){Object.defineProperty(x,"__esModule",{value:!0});x.pc=x.rc=x.nc=x.oc=x.kc=x.sc=void 0;y=function(n){function e(a,b,h,t,w,z){void 0===w&&(w=[]);void 0===z&&(z=!1);a=n.call(this,a,b,h,t,w)||this;a.yb="\u8fc7\u7a0b";a.wb=null;a.hb=!1;a.Z="11";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/
2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.C=!1;a.ca.C=!1;a.aa.C=!1;a.ba.C=!1;a.ub([a.da,a.ca,a.aa,a.ba]);a.Ka(z);return a}Y(e,n);e.prototype.clone=function(){return new e(r.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.u?this.u.text:[])};e.prototype.Ka=function(a){var b=new u.Rect(new f.h(0,0),this.w,this.j);this.lb(b);this.wb=b;a?(b.I=!0,b.O=!1,b.fillStyle="#0099FF"):(b.I=!1,b.O=!0,b.strokeStyle="#000000",b.lineWidth=2)};e.prototype.scale=function(a,b){var h;
n.prototype.scale.call(this,a,b);null===(h=this.wb)||void 0===h?void 0:h.scale(a,b,!1)};e.prototype.eb=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(A.cb);x.sc=y;y=function(n){function e(a,b,h,t,w,z){void 0===w&&(w=[]);void 0===z&&(z=!1);a=n.call(this,a,b,h,t,w)||this;
a.yb="\u5f00\u59cb/\u7ed3\u675f";a.wb=null;a.hb=!1;a.Z="12";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.C=!1;a.ca.C=!1;a.aa.C=!1;a.ba.C=!1;a.ub([a.da,a.ca,a.aa,a.ba]);a.Ka(z);return a}Y(e,n);e.prototype.clone=function(){return new e(r.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.u?this.u.text:[])};e.prototype.Ka=function(a){var b=
new u.lc(new f.h(0,0),this.w,this.j);this.lb(b);this.wb=b;a?(b.I=!0,b.O=!1,b.fillStyle="#0099FF"):(b.I=!1,b.O=!0,b.strokeStyle="#000000",b.lineWidth=2)};e.prototype.scale=function(a,b){var h;n.prototype.scale.call(this,a,b);null===(h=this.wb)||void 0===h?void 0:h.scale(a,b,!1)};e.prototype.eb=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);
this.fa.ondblclick=this.ondblclick};return e}(A.cb);x.kc=y;y=function(n){function e(a,b,h,t,w,z){void 0===w&&(w=[]);void 0===z&&(z=!1);a=n.call(this,a,b,h,t,w)||this;a.yb="\u51b3\u7b56";a.B=null;a.hb=!1;a.Z="13";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.C=!1;a.ca.C=!1;a.aa.C=!1;a.ba.C=!1;a.ub([a.da,a.ca,a.aa,a.ba]);a.Ka(z);return a}
Y(e,n);e.prototype.clone=function(){return new e(r.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.u?this.u.text:[])};e.prototype.Ka=function(a){var b=new f.la(this.w/2,0);this.B=new u.vb([b,new f.la(this.w,this.j/2),new f.la(this.w/2,this.j),new f.la(0,this.j/2),b]);this.lb(this.B);a?(this.B.I=!0,this.B.O=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.O=!0,this.B.strokeStyle="#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);this.B&&(this.B.H[0].x=
this.w/2,this.B.H[1].x=this.w,this.B.H[1].y=this.j/2,this.B.H[2].x=this.w/2,this.B.H[2].y=this.j,this.B.H[3].y=this.j/2)};e.prototype.eb=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(A.cb);x.oc=y;y=function(n){function e(a,b,h,t,w,z){void 0===w&&(w=[]);void 0===z&&(z=
!1);a=n.call(this,a,b,h,t,w)||this;a.yb="\u9875\u9762\u5185\u5f15\u7528";a.B=null;a.hb=!1;a.Z="14";b=2*Math.PI;a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.C=!1;a.ca.C=!1;a.aa.C=!1;a.ba.C=!1;a.ub([a.da,a.ca,a.aa,a.ba]);a.Ka(z);return a}Y(e,n);e.prototype.clone=function(){return new e(r.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.u?this.u.text:
[])};e.prototype.Ka=function(a){var b=new f.h(this.w/2,this.j/2);this.B=new u.qc(b,b);this.lb(this.B);a?(this.B.I=!0,this.B.O=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.O=!0,this.B.strokeStyle="#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);this.B&&(this.B.l.x=this.w/2,this.B.l.y=this.j/2)};e.prototype.eb=function(){this.da.P(this.w/2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,
a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(A.cb);x.nc=y;y=function(n){function e(a,b,h,t,w,z){void 0===w&&(w=[]);void 0===z&&(z=!1);a=n.call(this,a,b,h,t,w)||this;a.yb="\u6570\u636e";a.B=null;a.hb=!1;a.Z="15";b=2*Math.PI;h=a.j/a.w;h=h/(1+h)*a.w/4;a.u&&(a.u.l.x=2*h,a.u.w=a.w-4*h);a.da=new u.V(new f.h(a.w/2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w-h,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(h,
a.j/2),a.X,0,b,3,a.Y,1);a.da.C=!1;a.ca.C=!1;a.aa.C=!1;a.ba.C=!1;a.ub([a.da,a.ca,a.aa,a.ba]);a.Ka(z);return a}Y(e,n);e.prototype.clone=function(){return new e(r.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.u?this.u.text:[])};e.prototype.Ka=function(a){var b=this.j/this.w;b=b/(1+b)*this.w/2;var h=new f.la(b,0);this.B=new u.vb([h,new f.la(this.w,0),new f.la(this.w-b,this.j),new f.la(0,this.j),h]);this.lb(this.B);a?(this.B.I=!0,this.B.O=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.O=!0,this.B.strokeStyle=
"#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);a=this.j/this.w;a=a/(1+a)*this.w/2;this.B&&(this.B.H[0].x=a,this.B.H[1].x=this.w,this.B.H[2].x=this.w-a,this.B.H[2].y=this.j,this.B.H[3].y=this.j);this.u&&(this.u.l.x=a,this.u.w=this.w-2*a)};e.prototype.xc=function(){n.prototype.xc.call(this);var a=this.j/this.w;a=a/(1+a)*this.w/2;if(0<this.ia.length)for(var b=0;b<this.ia.length;b++){var h=this.ia[b];!h.fromPoint||1!=h.fromPoint.R&&3!=h.fromPoint.R||(1==
h.fromPoint.R?h.fromPoint.x=this.w-h.fromPoint.y/this.j*a:3==h.fromPoint.R&&(h.fromPoint.x=(this.j-h.fromPoint.y)/this.j*a),h.from.x=this.p.x+h.fromPoint.x,h.ma())}if(0<this.ha.length)for(b=0;b<this.ha.length;b++)h=this.ha[b],!h.F||1!=h.F.R&&3!=h.F.R||(1==h.F.R?h.F.x=this.w-h.F.y/this.j*a:3==h.F.R&&(h.F.x=(this.j-h.F.y)/this.j*a),h.g.x=this.p.x+h.F.x,h.ma())};e.prototype.eb=function(){var a=this.j/this.w;a=a/(1+a)*this.w/4;this.da.P(this.w/2,0);this.ca.P(this.w-a,this.j/2);this.aa.P(this.w/2,this.j);
this.ba.P(a,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a);if(a.T){var b=this.j/this.w;b=b/(1+b)*this.w/2;a.T.style.left=this.p.x+b+"px";a.T.style.width=this.w-2*b+"px"}};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(A.cb);x.rc=y;A=function(n){function e(a,b,h,t,w,z){void 0===w&&(w=[]);void 0===z&&(z=!1);a=n.call(this,a,b,h,t,w)||this;a.yb="\u6587\u6863";a.B=null;a.hb=!1;a.Z="16";b=2*Math.PI;a.da=new u.V(new f.h(a.w/
2,0),a.X,0,b,0,a.Y,1);a.ca=new u.V(new f.h(a.w,a.j/2),a.X,0,b,1,a.Y,1);a.aa=new u.V(new f.h(a.w/2,a.j),a.X,0,b,2,a.Y,1);a.ba=new u.V(new f.h(0,a.j/2),a.X,0,b,3,a.Y,1);a.da.C=!1;a.ca.C=!1;a.aa.C=!1;a.ba.C=!1;a.ub([a.da,a.ca,a.aa,a.ba]);a.Ka(z);return a}Y(e,n);e.prototype.clone=function(){return new e(r.K.W(),new f.h(this.p.x,this.p.y),this.w,this.j,this.u?this.u.text:[])};e.prototype.Ka=function(a){var b=new f.la(0,this.j,1),h=new f.la(this.w,this.j,1);this.B=new u.vb([b,new f.la(0,0),new f.la(this.w,
0),h,new f.la(this.w/4*3,this.j/4*3,1),new f.la(this.w/4,this.j/4*5,1),b]);this.lb(this.B);a?(this.B.I=!0,this.B.O=!1,this.B.fillStyle="#0099FF"):(this.B.I=!1,this.B.O=!0,this.B.strokeStyle="#000000",this.B.lineWidth=2)};e.prototype.scale=function(a,b){n.prototype.scale.call(this,a,b);this.B&&(this.B.H[0].y=this.j,this.B.H[2].x=this.w,this.B.H[3].x=this.w,this.B.H[3].y=this.j,this.B.H[4].x=this.w/4*3,this.B.H[4].y=this.j/4*3,this.B.H[5].x=this.w/4,this.B.H[5].y=this.j/4*5)};e.prototype.eb=function(){this.da.P(this.w/
2,0);this.ca.P(this.w,this.j/2);this.aa.P(this.w/2,this.j);this.ba.P(0,this.j/2)};e.prototype.ondblclick=function(a){n.prototype.ondblclick.call(this,a)};e.prototype.ja=function(){n.prototype.ja.call(this);this.fa.ondblclick=this.ondblclick};return e}(A.cb);x.pc=A});
define("layer/ModelLayer",["require","exports","core/base/BaseBean","AntLiuApp"],function(y,x,f,u){Object.defineProperty(x,"__esModule",{value:!0});x.Tc=void 0;y=function(){function A(r){this.J=[];this.anchorNode=this.ka=null;this.L=!1;this.Ua=new f.h(1,1);this.hb=!1;this.A=this.U=null;this.Ja=this.Aa=0;this.G=new f.h(0,0);this.Jc=this.de=this.ke=5;this.Sd=10;this.od=20;if(this.id=r)if(r=document.getElementById(r))if(this.Aa=r.clientWidth,this.Ja=500,this.A=document.createElement("canvas"),this.A.width=
this.Aa,this.A.height=this.Ja,r.appendChild(this.A),this.U=this.A.getContext("2d"))this.U.imageSmoothingEnabled=!0,r=window.devicePixelRatio,this.A.style.width=this.Aa+"px",this.A.style.height=this.Ja+"px",this.A.width=this.Aa*r,this.A.height=this.Ja*r,this.U.scale(r,r),this.Ic()}A.prototype.be=function(){if(this.A)for(var r=this.Jc,n=this.ke,e=!0,a=0;a<this.J.length;a++){var b=this.J[a];e?e=!1:r+b.w+this.de>this.Aa&&(r=this.Jc,n=n+b.j+this.od);b.p.x=r;b.p.y=n;r=r+b.w+this.Sd;r>this.Aa&&(e=!0,r=this.Jc,
n=n+b.j+this.od)}};A.prototype.Ma=function(r){this.J.push(r)};A.prototype.sa=function(){if(this.A&&this.U&&(this.U.clearRect(0,0,this.A.width,this.A.height),0<this.J.length))for(var r=0;r<this.J.length;r++)this.J[r].show(this.U);this.L=!1};A.prototype.Ec=function(r){this.G.x=1==this.Ua.x?r.offsetX:r.offsetX/this.Ua.x;this.G.y=1==this.Ua.y?r.offsetY:r.offsetY/this.Ua.y;"mousemove"==r.type?this.Rc(r):"mousedown"==r.type?this.Qc(r):"mouseup"==r.type&&this.le()};A.prototype.ec=function(){this.anchorNode&&
(this.anchorNode=null,u.ua&&(u.ua.Ab=!1))};A.prototype.le=function(){this.anchorNode&&(this.anchorNode=null,u.ua&&(u.ua.Ab=!1))};A.prototype.Qc=function(r){if(1==r.buttons&&this.J){r=!1;for(var n=this.G.x,e=this.G.y,a=this.J.length-1;-1<a;a--){var b=this.J[a];if(n>b.p.x&&e>b.p.y&&n<b.p.x+b.w&&e<b.p.y+b.j){r=!0;this.anchorNode=b;u.ua&&(u.ua.Ab=!0,u.ua.hd=this.anchorNode.Z);break}}!r&&this.anchorNode&&(this.anchorNode=null)}};A.prototype.Rc=function(r){if(1!=r.buttons||!this.anchorNode)if(this.anchorNode&&
(this.anchorNode=null),r=!1,this.J){for(var n=this.G.x,e=this.G.y,a=this.J.length-1;-1<a;a--){var b=this.J[a];if(n>b.p.x&&e>b.p.y&&n<b.p.x+b.w&&e<b.p.y+b.j){r=!0;this.ka?this.ka!=b&&(this.ka=b):this.ka=b;break}}!r&&this.ka&&(this.ka=null)}};A.prototype.Ic=function(){if(this.A){var r=this,n=function(e){r.Ec(e);e.stopPropagation()};this.A.onmousedown=n;this.A.onmouseup=n;this.A.onmousemove=n;document.addEventListener("mouseup",function(){r.ec()})}};return A}();x.Tc=y});
define("AntLiuApp","require exports process/ProcProc core/base/BaseBean layer/ModelLayer layer/DrawLayer util/CommonUtil".split(" "),function(y,x,f,u,A,r,n){function e(){var b=document.getElementById(a.lineBtBsizer);b&&(b.onclick=function(){x.ua&&x.ua.ad(2)});if(b=document.getElementById(a.lineBtPloy))b.onclick=function(){x.ua&&x.ua.ad(0)};if(b=document.getElementById(a.canvasImgDownBt))b.onclick=function(){x.ua&&x.ua.ee()}}Object.defineProperty(x,"__esModule",{value:!0});x.Ad=x.Pa=x.ua=void 0;var a=
{};x.Ad=function(b,h){if(b=document.getElementById(b)){h&&(a=h);var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;b.style.height=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)-100+"px";b.style.width=t+"px";h=document.createElement("div");h.id=n.K.W();h.style.width=t-150-5+"px";h.className="canvasBox";t=document.createElement("div");t.id=n.K.W();t.className="modelBox";b.appendChild(t);b.appendChild(h);x.ua=new r.Sc(h.id);
if(b=document.getElementById(t.id))h=n.K.W(),t=document.createElement("div"),t.id=h,t.style.width="100%",b.appendChild(t),x.Pa=new A.Tc(h),x.Pa.Ma(new f.sc(n.K.W(),new u.h(5,5),40,20)),x.Pa.Ma(new f.kc(n.K.W(),new u.h(5,5),40,20)),x.Pa.Ma(new f.oc(n.K.W(),new u.h(5,5),40,20)),x.Pa.Ma(new f.nc(n.K.W(),new u.h(5,5),20,20)),x.Pa.Ma(new f.rc(n.K.W(),new u.h(5,5),40,20)),x.Pa.Ma(new f.pc(n.K.W(),new u.h(5,5),40,20)),x.Pa.be(),x.Pa.sa();e()}}});
